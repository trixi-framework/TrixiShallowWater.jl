<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · TrixiShallowWater.jl</title><meta name="title" content="Reference · TrixiShallowWater.jl"/><meta property="og:title" content="Reference · TrixiShallowWater.jl"/><meta property="twitter:title" content="Reference · TrixiShallowWater.jl"/><meta name="description" content="Documentation for TrixiShallowWater.jl."/><meta property="og:description" content="Documentation for TrixiShallowWater.jl."/><meta property="twitter:description" content="Documentation for TrixiShallowWater.jl."/><meta property="og:url" content="https://trixi-framework.github.io/TrixiShallowWater.jl/reference/"/><meta property="twitter:url" content="https://trixi-framework.github.io/TrixiShallowWater.jl/reference/"/><link rel="canonical" href="https://trixi-framework.github.io/TrixiShallowWater.jl/reference/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TrixiShallowWater.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/introduction/">Introduction</a></li><li><a class="tocitem" href="../tutorials/elixir_shallowwater_dam_break_triangular/">Dam break over triangular bottom topograhy</a></li><li><a class="tocitem" href="../tutorials/elixir_shallowwater_monai_tsunami/">Okushiri tsunami</a></li></ul></li><li><span class="tocitem">Advanced topics &amp; developers</span><ul><li><a class="tocitem" href="../development/">Development</a></li><li><a class="tocitem" href="../styleguide/">Style guide</a></li><li><a class="tocitem" href="../testing/">Testing</a></li></ul></li><li><a class="tocitem" href="../changelog/">Changelog</a></li><li><a class="tocitem" href="../authors/">Authors</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li><li class="is-active"><a class="tocitem" href>Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/main/docs/src/reference.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="TrixiShallowWater.jl-API"><a class="docs-heading-anchor" href="#TrixiShallowWater.jl-API">TrixiShallowWater.jl API</a><a id="TrixiShallowWater.jl-API-1"></a><a class="docs-heading-anchor-permalink" href="#TrixiShallowWater.jl-API" title="Permalink"></a></h1><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_hll_chen_noelle"><a class="docstring-binding" href="#TrixiShallowWater.flux_hll_chen_noelle"><code>TrixiShallowWater.flux_hll_chen_noelle</code></a> — <span class="docstring-category">Constant</span></summary><section><div><pre><code class="language-julia hljs">flux_hll_chen_noelle = FluxHLL(min_max_speed_chen_noelle)</code></pre><p>An instance of <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.FluxHLL"><code>Trixi.FluxHLL</code></a> specific to the shallow water equations that uses the wave speed estimates from <a href="#TrixiShallowWater.min_max_speed_chen_noelle-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>min_max_speed_chen_noelle</code></a>. This HLL flux is guaranteed to have zero numerical mass flux out of a &quot;dry&quot; element, maintain positivity of the water height, and satisfy an entropy inequality.</p><p>For complete details see Section 2.4 of the following reference</p><ul><li>Guoxian Chen and Sebastian Noelle (2017) A new hydrostatic reconstruction scheme based on subcell reconstructions <a href="https://doi.org/10.1137/15M1053074">DOI: 10.1137/15M1053074</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/numerical_fluxes.jl#L17-L29">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_nonconservative_ersing_etal_local_jump-Tuple{Any, Any, Integer, ShallowWaterMultiLayerEquations2D, Trixi.NonConservativeJump, Integer}"><a class="docstring-binding" href="#TrixiShallowWater.flux_nonconservative_ersing_etal_local_jump-Tuple{Any, Any, Integer, ShallowWaterMultiLayerEquations2D, Trixi.NonConservativeJump, Integer}"><code>TrixiShallowWater.flux_nonconservative_ersing_etal_local_jump</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_ersing_local_jump(u_ll, u_rr, orientation::Integer,
                                       equations::ShallowWaterMultiLayerEquations2D,
                                       nonconservative_type::Trixi.NonConservativeJump,
                                       nonconservative_term::Integer)
flux_nonconservative_ersing_local_jump(u_ll, u_rr,
                                       normal_direction::AbstractVector,
                                       equations::ShallowWaterMultiLayerEquations2D,
                                       nonconservative_type::Trixi.NonConservativeJump,
                                       nonconservative_term::Integer)</code></pre><p>Jump part of the nonconservative term needed for the calculation of the non-conservative staggered &quot;fluxes&quot; for the subcell limiting in <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.VolumeIntegralSubcellLimiting"><code>Trixi.VolumeIntegralSubcellLimiting</code></a>.</p><p><strong>References</strong></p><ul><li>Rueda-Ramírez, Gassner (2023). A Flux-Differencing Formula for Split-Form Summation By Parts Discretizations of Non-Conservative Systems. https://arxiv.org/pdf/2211.14009.pdf.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_2d.jl#L724-L741">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_nonconservative_ersing_etal_local_jump-Tuple{Any, Integer, ShallowWaterMultiLayerEquations2D, Trixi.NonConservativeLocal, Integer}"><a class="docstring-binding" href="#TrixiShallowWater.flux_nonconservative_ersing_etal_local_jump-Tuple{Any, Integer, ShallowWaterMultiLayerEquations2D, Trixi.NonConservativeLocal, Integer}"><code>TrixiShallowWater.flux_nonconservative_ersing_etal_local_jump</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_ersing_local_jump(u_ll, u_rr, orientation::Integer,
                                       equations::ShallowWaterMultiLayerEquations2D,
                                       nonconservative_type::Trixi.NonConservativeLocal,
                                       nonconservative_term::Integer)
flux_nonconservative_ersing_local_jump(u_ll, u_rr,
                                       normal_direction::AbstractVector,
                                       equations::ShallowWaterMultiLayerEquations2D,
                                       nonconservative_type::Trixi.NonConservativeLocal,
                                       nonconservative_term::Integer)</code></pre><p>Local part of the nonconservative term needed for the calculation of the non-conservative staggered &quot;fluxes&quot; for the subcell limiting in <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.VolumeIntegralSubcellLimiting"><code>Trixi.VolumeIntegralSubcellLimiting</code></a>.</p><p><strong>References</strong></p><ul><li>Rueda-Ramírez, Gassner (2023). A Flux-Differencing Formula for Split-Form Summation By Parts Discretizations of Non-Conservative Systems. https://arxiv.org/pdf/2211.14009.pdf.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_2d.jl#L650-L667">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.BoundaryConditionMomentum-Union{Tuple{RealT}, Tuple{Real, Real, ShallowWaterEquations2D{RealT}}} where RealT"><a class="docstring-binding" href="#TrixiShallowWater.BoundaryConditionMomentum-Union{Tuple{RealT}, Tuple{Real, Real, ShallowWaterEquations2D{RealT}}} where RealT"><code>TrixiShallowWater.BoundaryConditionMomentum</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">BoundaryConditionMomentum(hv1_boundary, hv2_boundary, equations::ShallowWaterEquations2D)</code></pre><p>Create a boundary condition that sets a fixed momentum in x- and y- directions, <code>hv1_boundary</code> and <code>hv2_boundary</code>, at the boundary and extrapolates the water height <code>h_boundary</code> from the incoming Riemann invariant.</p><p>The external momentum can be specified as a constant value or as a function of time, e.g.</p><pre><code class="language-julia hljs">   BoundaryConditionMomentum(hv1_boundary, hv2_boundary, equations)
   BoundaryConditionMomentum(t -&gt; hv1_boundary(t), t -&gt; hv2_boundary(t), equations)</code></pre><p>More details can be found in the paper:</p><ul><li>Lixiang Song, Jianzhong Zhou, Jun Guo, Qiang Zou, Yi Liu (2011) A robust well-balanced finite volume model for shallow water flows with wetting and drying over irregular terrain <a href="https://doi.org/10.1016/j.advwatres.2011.04.017">doi: 10.1016/j.advwatres.2011.04.017</a></li></ul><div class="admonition is-warning" id="Experimental-code-99381045e2799ac2"><header class="admonition-header">Experimental code<a class="admonition-anchor" href="#Experimental-code-99381045e2799ac2" title="Permalink"></a></header><div class="admonition-body"><p>This is an experimental feature and can change any time.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L428-L449">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.BoundaryConditionMomentum-Union{Tuple{RealT}, Tuple{Real, ShallowWaterEquations1D{RealT}}} where RealT"><a class="docstring-binding" href="#TrixiShallowWater.BoundaryConditionMomentum-Union{Tuple{RealT}, Tuple{Real, ShallowWaterEquations1D{RealT}}} where RealT"><code>TrixiShallowWater.BoundaryConditionMomentum</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">BoundaryConditionMomentum(hv_boundary, equations::ShallowWaterEquations1D)</code></pre><p>Create a boundary condition that sets a fixed momentum <code>hv_boundary</code> at the boundary and  extrapolates the water height <code>h_boundary</code> from the incoming Riemann invariant.</p><p>The external momentum can be specified as a constant value or as a function of time, e.g.</p><pre><code class="language-julia hljs">   BoundaryConditionMomentum(hv_boundary, equations)
   BoundaryConditionMomentum(t -&gt; hv_boundary(t), equations)</code></pre><p>More details can be found in the paper:</p><ul><li>Lixiang Song, Jianzhong Zhou, Jun Guo, Qiang Zou, Yi Liu (2011) A robust well-balanced finite volume model for shallow water flows with wetting and drying over irregular terrain <a href="https://doi.org/10.1016/j.advwatres.2011.04.017">doi: 10.1016/j.advwatres.2011.04.017</a></li></ul><div class="admonition is-warning" id="Experimental-code-99381045e2799ac2"><header class="admonition-header">Experimental code<a class="admonition-anchor" href="#Experimental-code-99381045e2799ac2" title="Permalink"></a></header><div class="admonition-body"><p>This is an experimental feature and can change any time.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L323-L343">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.BoundaryConditionWaterHeight-Union{Tuple{RealT}, Tuple{Real, ShallowWaterEquations1D{RealT}}} where RealT"><a class="docstring-binding" href="#TrixiShallowWater.BoundaryConditionWaterHeight-Union{Tuple{RealT}, Tuple{Real, ShallowWaterEquations1D{RealT}}} where RealT"><code>TrixiShallowWater.BoundaryConditionWaterHeight</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">BoundaryConditionWaterHeight(h_boundary, equations::ShallowWaterEquations1D)</code></pre><p>Create a boundary condition that uses <code>h_boundary</code> to specify a fixed water height at the  boundary and extrapolates the velocity from the incoming Riemann invariant.</p><p>The external water height <code>h_boundary</code> can be specified as a constant value or as a function of time, e.g.</p><pre><code class="language-julia hljs">   BoundaryConditionWaterHeight(h_boundary, equations))
   BoundaryConditionWaterHeight(t -&gt; h_boundary(t), equations))</code></pre><p>More details can be found in the paper:</p><ul><li>Lixiang Song, Jianzhong Zhou, Jun Guo, Qiang Zou, Yi Liu (2011) A robust well-balanced finite volume model for shallow water flows with wetting and drying over irregular terrain <a href="https://doi.org/10.1016/j.advwatres.2011.04.017">doi: 10.1016/j.advwatres.2011.04.017</a></li></ul><div class="admonition is-warning" id="Experimental-code-99381045e2799ac2"><header class="admonition-header">Experimental code<a class="admonition-anchor" href="#Experimental-code-99381045e2799ac2" title="Permalink"></a></header><div class="admonition-body"><p>This is an experimental feature and can change any time.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L250-L270">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.BoundaryConditionWaterHeight-Union{Tuple{RealT}, Tuple{Real, ShallowWaterEquations2D{RealT}}} where RealT"><a class="docstring-binding" href="#TrixiShallowWater.BoundaryConditionWaterHeight-Union{Tuple{RealT}, Tuple{Real, ShallowWaterEquations2D{RealT}}} where RealT"><code>TrixiShallowWater.BoundaryConditionWaterHeight</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">BoundaryConditionWaterHeight(h_boundary, equations::ShallowWaterEquations2D)</code></pre><p>Create a boundary condition that uses <code>h_boundary</code> to specify a fixed water height at the boundary and extrapolates the velocity from the incoming Riemann invariant.</p><p>The external water height <code>h_boundary</code> can be specified as a constant value or as a function of time, e.g.</p><pre><code class="language-julia hljs">   BoundaryConditionWaterHeight(h_boundary, equations))
   BoundaryConditionWaterHeight(t -&gt; h_boundary(t), equations))</code></pre><p>More details can be found in the paper:</p><ul><li>Lixiang Song, Jianzhong Zhou, Jun Guo, Qiang Zou, Yi Liu (2011) A robust well-balanced finite volume model for shallow water flows with wetting and drying over irregular terrain <a href="https://doi.org/10.1016/j.advwatres.2011.04.017">doi: 10.1016/j.advwatres.2011.04.017</a></li></ul><div class="admonition is-warning" id="Experimental-code-99381045e2799ac2"><header class="admonition-header">Experimental code<a class="admonition-anchor" href="#Experimental-code-99381045e2799ac2" title="Permalink"></a></header><div class="admonition-body"><p>This is an experimental feature and can change any time.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L293-L313">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.FluxHydrostaticReconstruction"><a class="docstring-binding" href="#TrixiShallowWater.FluxHydrostaticReconstruction"><code>TrixiShallowWater.FluxHydrostaticReconstruction</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">FluxHydrostaticReconstruction(numerical_flux, hydrostatic_reconstruction)</code></pre><p>Allow for some kind of hydrostatic reconstruction of the solution state prior to the surface flux computation. This is a particular strategy to ensure that the method remains well-balanced for the shallow water equations, see <a href="#TrixiShallowWater.ShallowWaterEquations1D"><code>ShallowWaterEquations1D</code></a> or <a href="#TrixiShallowWater.ShallowWaterEquations2D"><code>ShallowWaterEquations2D</code></a>.</p><p>For example, the hydrostatic reconstruction from Audusse et al. is implemented in one and two spatial dimensions, see <a href="#TrixiShallowWater.hydrostatic_reconstruction_audusse_etal-Tuple{Any, Any, ShallowWaterEquations1D}"><code>hydrostatic_reconstruction_audusse_etal</code></a> or the original paper</p><ul><li>Emmanuel Audusse, François Bouchut, Marie-Odile Bristeau, Rupert Klein, and Benoit Perthame (2004) A fast and stable well-balanced scheme with hydrostatic reconstruction for shallow water flows <a href="https://doi.org/10.1137/S1064827503431090">DOI: 10.1137/S1064827503431090</a></li></ul><p>Other hydrostatic reconstruction techniques are available, particularly to handle wet / dry fronts. A good overview of the development and application of hydrostatic reconstruction can be found in</p><ul><li>Guoxian Chen and Sebastian Noelle A unified surface-gradient and hydrostatic reconstruction scheme for the shallow water equations (2021) <a href="https://www.igpm.rwth-aachen.de/forschung/preprints/517">RWTH Aachen preprint</a></li><li>Andreas Buttinger-Kreuzhuber, Zsolt Horváth, Sebastian Noelle, Günter Blöschl and Jürgen Waser (2019) A fast second-order shallow water scheme on two-dimensional structured grids over abrupt topography <a href="https://doi.org/10.1016/j.advwatres.2019.03.010">DOI: 10.1016/j.advwatres.2019.03.010</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/numerical_fluxes.jl#L33-L56">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.FluxNonConservativeErsingLocalJump-Tuple{Any, Any, Integer, ShallowWaterMultiLayerEquations2D}"><a class="docstring-binding" href="#TrixiShallowWater.FluxNonConservativeErsingLocalJump-Tuple{Any, Any, Integer, ShallowWaterMultiLayerEquations2D}"><code>TrixiShallowWater.FluxNonConservativeErsingLocalJump</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_ersing_etal_local_jump(u_ll, u_rr, orientation::Integer,
                                            equations::ShallowWaterMultiLayerEquations2D)
flux_nonconservative_ersing_etal_local_jump(u_ll, u_rr,
                                            normal_direction::AbstractVector,
                                            equations::ShallowWaterMultiLayerEquations2D)</code></pre><p>Non-symmetric path-conservative two-point flux discretizing the nonconservative (source) term that contains the gradients of the bottom topography and waterheights from the coupling between layers and the nonconservative pressure formulation <a href="#TrixiShallowWater.ShallowWaterMultiLayerEquations2D"><code>ShallowWaterMultiLayerEquations2D</code></a>.</p><p>If the bottom topography is nonzero this scheme will be well-balanced when used together with <a href="#TrixiShallowWater.flux_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterExnerEquations1D}"><code>flux_ersing_etal</code></a>.</p><p>This implementation uses a non-conservative term that can be written as the product of local and jump parts. </p><p>The two other flux functions with the same name return either the local or jump portion of the non-conservative flux based on the type of the nonconservative_type argument, employing multiple dispatch. They are used to compute the subcell fluxes in <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.VolumeIntegralSubcellLimiting"><code>Trixi.VolumeIntegralSubcellLimiting</code></a>.</p><p><strong>References</strong></p><ul><li>Rueda-Ramírez, Gassner (2023). A Flux-Differencing Formula for Split-Form Summation By Parts Discretizations of Non-Conservative Systems. https://arxiv.org/pdf/2211.14009.pdf.</li></ul><p>In the two-layer setting this combination is equivalent to the fluxes in:</p><ul><li>Patrick Ersing, Andrew R. Winters (2023) An entropy stable discontinuous Galerkin method for the two-layer shallow water equations on curvilinear meshes <a href="https://doi.org/10.1007/s10915-024-02451-2">DOI: 10.1007/s10915-024-02451-2</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_2d.jl#L605-L636">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.GrassModel"><a class="docstring-binding" href="#TrixiShallowWater.GrassModel"><code>TrixiShallowWater.GrassModel</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">GrassModel(; A_g, m_g=3)</code></pre><p>Creates a Grass model to compute the sediment discharge <code>q_s</code> as</p><p class="math-container">\[q_s = A_g v^{m_g}\]</p><p>with the coefficients <code>A_g</code> and <code>m_g</code>. The constant <code>A_g</code> lies in the interval <span>$[0,1]$</span> and is a dimensional calibration constant that is usually measured experimentally. It expresses the kind of interaction between the fluid and the sediment, the strength of which increases as <code>A_g</code> approaches to 1. The factor <code>m_g</code> lies in the interval <span>$[1, 4]$</span>. Typically, one considers an odd integer value for <code>m_g</code> such that the sediment discharge <code>q_s</code> can be differentiated and the model remains valid for all values of the velocity <code>v</code>.</p><p>An overview of different formulations to compute the sediment discharge can be found in:</p><ul><li>M.J. Castro Díaz, E.D. Fernández-Nieto, A.M. Ferreiro (2008)<br/>Sediment transport models in Shallow Water equations and numerical approach by high order finite volume methods<br/><a href="https://doi.org/10.1016/j.compfluid.2007.07.017">DOI:10.1016/j.compfluid.2007.07.017</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_exner_1d.jl#L58-L77">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.IndicatorHennemannGassnerShallowWater"><a class="docstring-binding" href="#TrixiShallowWater.IndicatorHennemannGassnerShallowWater"><code>TrixiShallowWater.IndicatorHennemannGassnerShallowWater</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">IndicatorHennemannGassnerShallowWater(equations::AbstractEquations, basis;
                                      alpha_max=0.5,
                                      alpha_min=0.001,
                                      alpha_smooth=true,
                                      variable)</code></pre><p>Modified version of the <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.IndicatorHennemannGassner"><code>Trixi.IndicatorHennemannGassner</code></a> indicator used for shock-capturing for shallow water equations. After the element-wise values for the blending factors are computed an additional check is made to see if the element is partially wet. In this case, partially wet elements are set to use the pure finite volume scheme that is guaranteed to be well-balanced for this wet/dry transition state of the flow regime.</p><p>See also <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.VolumeIntegralShockCapturingHG"><code>Trixi.VolumeIntegralShockCapturingHG</code></a>.</p><p><strong>References</strong></p><ul><li>Hennemann, Gassner (2020) &quot;A provably entropy stable subcell shock capturing approach for high order split form DG&quot; <a href="https://arxiv.org/abs/2008.12044">arXiv: 2008.12044</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/solvers/indicators.jl#L8-L29">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.ManningFriction"><a class="docstring-binding" href="#TrixiShallowWater.ManningFriction"><code>TrixiShallowWater.ManningFriction</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ManningFriction(; n)</code></pre><p>Creates a Manning friction model for the bottom friction with Manning coefficient <code>n</code>. The type is used to dispatch on the respective friction law through the <code>shear_stress_coefficient</code> when computing the <code>shear_stress</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_exner_1d.jl#L11-L17">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.PositivityPreservingLimiterShallowWater"><a class="docstring-binding" href="#TrixiShallowWater.PositivityPreservingLimiterShallowWater"><code>TrixiShallowWater.PositivityPreservingLimiterShallowWater</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">PositivityPreservingLimiterShallowWater(; variables)</code></pre><p>The limiter is specifically designed for the shallow water equations. It is applied to all scalar <code>variables</code> in their given order using the defined <code>threshold_limiter</code> from the equations struct  (e.g. in <a href="#TrixiShallowWater.ShallowWaterEquations1D"><code>ShallowWaterEquations1D</code></a>) to determine the minimal acceptable values. The order of the <code>variables</code> is important and might have a strong influence on the robustness. The limiter is available for the <a href="#TrixiShallowWater.ShallowWaterEquations1D"><code>ShallowWaterEquations1D</code></a>, <a href="#TrixiShallowWater.ShallowWaterEquations2D"><code>ShallowWaterEquations2D</code></a>, and <a href="#TrixiShallowWater.ShallowWaterMultiLayerEquations1D"><code>ShallowWaterMultiLayerEquations1D</code></a>.</p><p>As opposed to the standard version of the <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.PositivityPreservingLimiterZhangShu"><code>Trixi.PositivityPreservingLimiterZhangShu</code></a>, nodes with a water height below the <code>threshold_limiter</code> are treated in a special way. To avoid numerical problems caused by velocities close to zero, the velocity is cut off, such that the node can be identified as &quot;dry&quot;. The special feature of the <code>ShallowWaterEquations</code> used here is that the bottom topography is stored as an additional quantity in the solution vector <code>u</code>. However, the value of the bottom topography should not be changed. That is why, it is not limited.</p><p>After the limiting process is applied to all degrees of freedom, for safety reasons, the <code>threshold_limiter</code> is applied again on all the DG nodes in order to avoid water height below. In the case where the cell mean value is below the threshold before applying the limiter, there could still be dry nodes afterwards due to the logic of the limiter. Additionally, a velocity  desingularization is applied after the limiting to avoid numerical problems near dry states. Details about the desingularization strategy can be found in Section 2.2 of the paper</p><ul><li>A. Kurganov, G. Petrova (2007) A second-order well-balanced positivity preserving central-upwind scheme for the Saint-Venant system <a href="https://dx.doi.org/10.4310/CMS.2007.v5.n1.a6">doi: 10.4310/CMS.2007.v5.n1.a6</a></li></ul><p>For the <a href="#TrixiShallowWater.ShallowWaterMultiLayerEquations1D"><code>ShallowWaterMultiLayerEquations1D</code></a> the implementation differs. In this case the  positivity limiter is applied layerwise and only the waterheight <code>h</code> is limited within each layer.</p><p>This fully-discrete positivity-preserving limiter is based on the work of</p><ul><li>Zhang, Shu (2011) Maximum-principle-satisfying and positivity-preserving high-order schemes for conservation laws: survey and new developments <a href="https://doi.org/10.1098/rspa.2011.0153">doi: 10.1098/rspa.2011.0153</a></li></ul><p>The specific implementation for the <a href="#TrixiShallowWater.ShallowWaterMultiLayerEquations1D">`ShallowWaterMultiLayerEquations1D</a> is based on the work of</p><ul><li>Y. Xing, X. Zhang (2013) Positivity-preserving well-balanced discontinuous Galerkin methods for the shallow water equations on unstructured triangular meshes <a href="https://doi.org/10.1007/s10915-012-9644-4">doi: 10.1007/s10915-012-9644-4</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/callbacks_stage/positivity_shallow_water.jl#L8-L50">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.ShallowWaterEquations1D"><a class="docstring-binding" href="#TrixiShallowWater.ShallowWaterEquations1D"><code>TrixiShallowWater.ShallowWaterEquations1D</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ShallowWaterEquations1D(; gravity, H0 = 0, threshold_limiter = nothing, threshold_wet = nothing,
                        threshold_partially_wet = nothing, threshold_desingularization = nothing)</code></pre><p>Shallow water equations (SWE) in one space dimension. The equations are given by</p><p class="math-container">\[\begin{aligned}
  \frac{\partial h}{\partial t} + \frac{\partial}{\partial x}(h v) &amp;= 0 \\
    \frac{\partial}{\partial t}(h v) + \frac{\partial}{\partial x}\left(h v^2 + \frac{g}{2}h^2\right)
    + g h \frac{\partial b}{\partial x} &amp;= 0
\end{aligned}\]</p><p>The unknown quantities of the SWE are the water height <span>$h$</span> and the velocity <span>$v$</span>. The gravitational acceleration is denoted by <code>g</code> and the (possibly) variable bottom topography function <span>$b(x)$</span>. Conservative variable water height <span>$h$</span> is measured from the bottom topography <span>$b$</span>, therefore one also defines the total water height as <span>$H = h + b$</span>.</p><p>The additional quantity <span>$H_0$</span> is also available to store a reference value for the total water height that is useful to set initial conditions or test the &quot;lake-at-rest&quot; well-balancedness.</p><p>Also, there are four thresholds which prevent numerical problems as well as instabilities. None of them have to be passed, as default values are defined within the struct. The first one, <code>threshold_limiter</code>, is used in <a href="#TrixiShallowWater.PositivityPreservingLimiterShallowWater"><code>PositivityPreservingLimiterShallowWater</code></a> on the water height, as a (small) shift on the initial condition and cutoff before the next time step. The second one, <code>threshold_wet</code>, is applied on the water height to define when the flow is &quot;wet&quot; before calculating the numerical flux. A third <code>threshold_partially_wet</code> is applied on the water height to define &quot;partially wet&quot; elements in <a href="#TrixiShallowWater.IndicatorHennemannGassnerShallowWater"><code>IndicatorHennemannGassnerShallowWater</code></a>, that are then calculated with a pure FV method to ensure well-balancedness. Lastly, <code>threshold_desingularization</code> is used in <a href="#TrixiShallowWater.PositivityPreservingLimiterShallowWater"><code>PositivityPreservingLimiterShallowWater</code></a> for the velocity desingularization procedure. For <code>Float64</code> no threshold needs to be passed, as default values are defined within the struct. For other number formats <code>threshold_partially_wet</code> and <code>threshold_desingularization</code> must be provided.</p><p>The bottom topography function <span>$b(x)$</span> is set inside the initial condition routine for a particular problem setup. To test the conservative form of the SWE one can set the bottom topography variable <code>b</code> to zero.</p><p>In addition to the unknowns, Trixi.jl currently stores the bottom topography values at the approximation points despite being fixed in time. This is done for convenience of computing the bottom topography gradients on the fly during the approximation as well as computing auxiliary quantities like the total water height <span>$H$</span> or the entropy variables. This affects the implementation and use of these equations in various ways:</p><ul><li>The flux values corresponding to the bottom topography must be zero.</li><li>The bottom topography values must be included when defining initial conditions, boundary conditions or source terms.</li><li><a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.AnalysisCallback"><code>Trixi.AnalysisCallback</code></a> analyzes this variable.</li><li>Trixi.jl&#39;s visualization tools will visualize the bottom topography by default.</li></ul><p>References for the SWE are many but a good introduction is available in Chapter 13 of the book:</p><ul><li>Randall J. LeVeque (2002) Finite Volume Methods for Hyperbolic Problems <a href="https://doi.org/10.1017/CBO9780511791253">DOI: 10.1017/CBO9780511791253</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L8-L59">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.ShallowWaterEquations2D"><a class="docstring-binding" href="#TrixiShallowWater.ShallowWaterEquations2D"><code>TrixiShallowWater.ShallowWaterEquations2D</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ShallowWaterEquations2D(; gravity, H0 = 0, threshold_limiter = nothing, threshold_wet = nothing, 
                          threshold_partially_wet = nothing, threshold_desingularization = nothing)</code></pre><p>Shallow water equations (SWE) in two space dimensions. The equations are given by</p><p class="math-container">\[\begin{aligned}
  \frac{\partial h}{\partial t} + \frac{\partial}{\partial x}(h v_1)
    + \frac{\partial}{\partial y}(h v_2) &amp;= 0 \\
    \frac{\partial}{\partial t}(h v_1) + \frac{\partial}{\partial x}\left(h v_1^2 + \frac{g}{2}h^2\right)
    + \frac{\partial}{\partial y}(h v_1 v_2) + g h \frac{\partial b}{\partial x} &amp;= 0 \\
    \frac{\partial}{\partial t}(h v_2) + \frac{\partial}{\partial x}(h v_1 v_2)
    + \frac{\partial}{\partial y}\left(h v_2^2 + \frac{g}{2}h^2\right) + g h \frac{\partial b}{\partial y} &amp;= 0.
\end{aligned}\]</p><p>The unknown quantities of the SWE are the water height <span>$h$</span> and the velocities <span>$\mathbf{v} = (v_1, v_2)^T$</span>. The gravitational acceleration is denoted by <code>g</code> and the (possibly) variable bottom topography function <span>$b(x,y)$</span>. Conservative variable water height <span>$h$</span> is measured from the bottom topography <span>$b$</span>, therefore one also defines the total water height as <span>$H = h + b$</span>.</p><p>The additional quantity <span>$H_0$</span> is also available to store a reference value for the total water height that is useful to set initial conditions or test the &quot;lake-at-rest&quot; well-balancedness.</p><p>Also, there are four thresholds which prevent numerical problems as well as instabilities. None of them have to be passed, as default values are defined within the struct. The first one, <code>threshold_limiter</code>, is used in <a href="#TrixiShallowWater.PositivityPreservingLimiterShallowWater"><code>PositivityPreservingLimiterShallowWater</code></a> on the water height, as a (small) shift on the initial condition and cutoff before the next time step. The second one, <code>threshold_wet</code>, is applied on the water height to define when the flow is &quot;wet&quot; before calculating the numerical flux. A third <code>threshold_partially_wet</code> is applied on the water height to define &quot;partially wet&quot; elements in <a href="#TrixiShallowWater.IndicatorHennemannGassnerShallowWater"><code>IndicatorHennemannGassnerShallowWater</code></a>, that are then calculated with a pure FV method to ensure well-balancedness. Lastly, <code>threshold_desingularization</code> is used in <a href="#TrixiShallowWater.PositivityPreservingLimiterShallowWater"><code>PositivityPreservingLimiterShallowWater</code></a> for the velocity desingularization procedure. For <code>Float64</code> no threshold needs to be passed, as default values are defined within the struct. For other number formats  <code>threshold_partially_wet</code> and <code>threshold_desingularization</code> must be provided.</p><p>The bottom topography function <span>$b(x,y)$</span> is set inside the initial condition routine for a particular problem setup. To test the conservative form of the SWE one can set the bottom topography variable <code>b</code> to zero.</p><p>In addition to the unknowns, TrixiShallowWater.jl currently stores the bottom topography values at the approximation points despite being fixed in time. This is done for convenience of computing the bottom topography gradients on the fly during the approximation as well as computing auxiliary quantities like the total water height <span>$H$</span> or the entropy variables. This affects the implementation and use of these equations in various ways:</p><ul><li>The flux values corresponding to the bottom topography must be zero.</li><li>The bottom topography values must be included when defining initial conditions, boundary conditions or source terms.</li><li><a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.AnalysisCallback"><code>Trixi.AnalysisCallback</code></a> analyzes this variable.</li><li>Trixi.jl&#39;s visualization tools will visualize the bottom topography by default.</li></ul><p>References for the SWE are many but a good introduction is available in Chapter 13 of the book:</p><ul><li>Randall J. LeVeque (2002) Finite Volume Methods for Hyperbolic Problems <a href="https://doi.org/10.1017/CBO9780511791253">DOI: 10.1017/CBO9780511791253</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L7-L61">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.ShallowWaterEquationsQuasi1D"><a class="docstring-binding" href="#TrixiShallowWater.ShallowWaterEquationsQuasi1D"><code>TrixiShallowWater.ShallowWaterEquationsQuasi1D</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ShallowWaterEquationsQuasi1D(; gravity, H0 = 0)</code></pre><p>The quasi-1D shallow water equations (SWE). The equations are given by</p><p class="math-container">\[\begin{aligned}
  \frac{\partial}{\partial t}(a h) + \frac{\partial}{\partial x}(a h v) &amp;= 0 \\
    \frac{\partial}{\partial t}(a h v) + \frac{\partial}{\partial x}(a h v^2)
    + g a h \frac{\partial}{\partial x}(h + b) &amp;= 0
\end{aligned}\]</p><p>The unknown quantities of the Quasi-1D SWE are the water height <span>$h$</span> and the scaled velocity <span>$v$</span>. The gravitational acceleration is denoted by <code>g</code>, the (possibly) variable bottom topography function <span>$b(x)$</span>, and (possibly) variable channel width <span>$a(x)$</span>. The water height <span>$h$</span> is measured from the bottom topography <span>$b$</span>, therefore one also defines the total water height as <span>$H = h + b$</span>.</p><p>The additional quantity <span>$H_0$</span> is also available to store a reference value for the total water height that is useful to set initial conditions or test the &quot;lake-at-rest&quot; well-balancedness.</p><p>The bottom topography function <span>$b(x)$</span> and channel width <span>$a(x)$</span> are set inside the initial condition routine for a particular problem setup. To test the conservative form of the SWE one can set the bottom topography variable <code>b</code> to zero and <span>$a$</span> to one. </p><p>In addition to the unknowns, TrixiShallowWater.jl stores the bottom topography and channel width values at the approximation points  despite being fixed in time. This is done for convenience of computing the bottom topography gradients on the fly during the approximation as well as computing auxiliary quantities like the total water height <span>$H$</span> or the entropy variables. This affects the implementation and use of these equations in various ways:</p><ul><li>The flux values corresponding to the bottom topography and channel width must be zero.</li><li>The bottom topography and channel width values must be included when defining initial conditions, boundary conditions or source terms.</li><li><a href="../tutorials/elixir_shallowwater_dam_break_triangular/#AnalysisCallback"><code>AnalysisCallback</code></a> analyzes this variable.</li><li>Trixi.jl&#39;s visualization tools will visualize the bottom topography and channel width by default.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_quasi_1d.jl#L8-L39">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.ShallowWaterExnerEquations1D"><a class="docstring-binding" href="#TrixiShallowWater.ShallowWaterExnerEquations1D"><code>TrixiShallowWater.ShallowWaterExnerEquations1D</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ShallowWaterExnerEquations1D(;gravity, H0 = 0.0,
                             friction = ManningFriction(n = 0.0),
                             sediment_model,
                             porosity,
                             rho_f, rho_s)</code></pre><p>Formulation of the Shallow water-Exner equations in one space dimension that possesses a mathematical entropy inequality. The equations are given by</p><p class="math-container">\[\begin{cases}
\partial_t h + \partial_x hv = 0, \\
\partial_t hv + \partial_x (hv^2) + gh\partial_x (h + h_b) + g\frac{1}{r}h_s\partial_x (rh + h_b) + \frac{\tau}{\rho_f} = 0,\\
\partial_t h_b + \partial_x q_s = 0,
\end{cases}\]</p><p>The unknown quantities are the water and sediment height <span>$h$</span>, <span>$h_b$</span> and the velocity <span>$v$</span>. The sediment discharge <span>$q_s(h, hv)$</span> is determined by the <code>sediment_model</code> and is used to determine the active sediment height <span>$h_s = q_s / v$</span>. Furthermore <span>$\tau$</span> denotes the shear stress at the water-sediment interface and is determined by the <code>friction</code> model. The gravitational acceleration is denoted by <span>$g$</span>, and <span>$\rho_f$</span> and <span>$\rho_s$</span> are the fluid and sediment densities, respectively. The density ratio is given by <span>$r = \rho_f / \rho_s$</span>, where <span>$r$</span> lies between <span>$0 &lt; r &lt; 1$</span> as the fluid density <span>$\rho_f$</span> should be smaller than the sediment density <span>$\rho_s$</span>.</p><p>The conservative variable water height <span>$h$</span> is measured from the sediment height <span>$h_b$</span>, therefore one also defines the total water height as <span>$H = h + h_b$</span>.</p><p>The additional quantity <span>$H_0$</span> is also available to store a reference value for the total water height that is useful to set initial conditions or test the &quot;lake-at-rest&quot; well-balancedness.</p><p>The entropy conservative formulation has been derived in the paper:</p><ul><li>E.D. Fernández-Nieto, T.M. de Luna, G. Narbona-Reina and J. de Dieu Zabsonré (2017)<br/>Formal deduction of the Saint-Venant–Exner model including arbitrarily sloping sediment beds and associated energy<br/><a href="https://doi.org/10.1051/m2an/2016018">DOI: 10.1051/m2an/2016018</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_exner_1d.jl#L106-L141">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.ShallowWaterMultiLayerEquations1D"><a class="docstring-binding" href="#TrixiShallowWater.ShallowWaterMultiLayerEquations1D"><code>TrixiShallowWater.ShallowWaterMultiLayerEquations1D</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ShallowWaterMultiLayerEquations1D(gravity, H0, rhos)</code></pre><p>Multi-Layer Shallow Water equations (MLSWE) in one space dimension. The equations are given by</p><p class="math-container">\[\left\{
	\begin{aligned}			
		&amp;\partial_t h_m + \partial_x h_mv_m = 0,\\
		&amp;\partial h_mv_m + \partial_x h_mv_m^2 = -gh_m\partial_x \bigg(b + \sum\limits_{k\geq j}h_k + \sum\limits_{k&lt;m}\frac{\rho_k}{\rho_m}h_k \bigg)
	\end{aligned}
\right.\]</p><p>where <span>$m = 1, 2, ..., M$</span> is the layer index and the unknown variables are the water height <span>$h$</span> and the velocity <span>$v$</span>.  Furthermore, <span>$g$</span> denotes the gravitational acceleration, <span>$b(x)$</span> the bottom  topography and <span>$\rho_m$</span> the m-th layer density, that must be chosen such that  <span>$\rho_1 &lt; \rho_2 &lt; ... &lt; \rho_M$</span>, to ensure that different layers are ordered from top to bottom, with  increasing density.</p><p>We use a specific formulation of the system, where the pressure term is reformulated as a  nonconservative term, which has some benefits for the design of well-balanced schemes.</p><p>The additional quantity <span>$H_0$</span> is also available to store a reference value for the total water height that is useful to set initial conditions or test the &quot;lake-at-rest&quot; well-balancedness.</p><p>Also, there are two thresholds which prevent numerical problems as well as instabilities. The limiters are  used in <a href="#TrixiShallowWater.PositivityPreservingLimiterShallowWater"><code>PositivityPreservingLimiterShallowWater</code></a> on the water height. <code>threshold_limiter</code>  acts as a (small) shift on the initial condition and cutoff before the next time step, whereas  <code>threshold_desingularization</code> is used in the velocity desingularization. A third  <code>threshold_partially_wet</code> is applied on the water height to define &quot;partially wet&quot; elements in  <a href="#TrixiShallowWater.IndicatorHennemannGassnerShallowWater"><code>IndicatorHennemannGassnerShallowWater</code></a>, that are then calculated with a pure FV method to ensure well-balancedness. For <code>Float64</code> no threshold needs to be passed, as default values are  defined within the struct. For other number formats <code>threshold_desingularization</code> and <code>threshold_partially_wet</code>  must be provided.</p><p>The bottom topography function <span>$b(x)$</span> is set inside the initial condition routine for a particular problem setup.</p><p>In addition to the unknowns, Trixi currently stores the bottom topography values at the approximation points despite being fixed in time. This is done for convenience of computing the bottom topography gradients on the fly during the approximation as well as computing auxiliary quantities like the total water height <span>$H$</span> or the entropy variables. This affects the implementation and use of these equations in various ways:</p><ul><li>The flux values corresponding to the bottom topography must be zero.</li><li>The bottom topography values must be included when defining initial conditions, boundary conditions or source terms.</li><li><a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.AnalysisCallback"><code>Trixi.AnalysisCallback</code></a> analyzes this variable.</li><li>Trixi&#39;s visualization tools will visualize the bottom topography by default.</li></ul><p>A good introduction for the MLSWE is available in Chapter 12 of the book:     - Benoit Cushman-Roisin (2011)<br/>      Introduction to geophyiscal fluid dynamics: physical and numerical aspects<br/>      <a href="https://www.sciencedirect.com/bookseries/international-geophysics/vol/101/suppl/C">https://www.sciencedirect.com/bookseries/international-geophysics/vol/101/suppl/C</a><br/>      ISBN: 978-0-12-088759-0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_1d.jl#L8-L62">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.ShallowWaterMultiLayerEquations2D"><a class="docstring-binding" href="#TrixiShallowWater.ShallowWaterMultiLayerEquations2D"><code>TrixiShallowWater.ShallowWaterMultiLayerEquations2D</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ShallowWaterMultiLayerEquations2D(gravity, H0, rhos)</code></pre><p>Multi-Layer Shallow Water equations (MLSWE) in two space dimension. The equations are given by</p><p class="math-container">\[\left\{
	\begin{aligned}
		&amp;\partial_t h_m + \partial_x h_mv_m = 0,\\
		&amp;\partial h_mv1_m + \partial_x h_mv1_m^2 + \partial_y h_mv1_mv2_m = -gh_m\partial_x \bigg(b + \sum\limits_{k\geq j}h_k + \sum\limits_{k&lt;m}\frac{\rho_k}{\rho_m}h_k \bigg)
        &amp;\partial h_mv2_m + \partial_x h_mv1_mv2_m + \partial_y h_mv2_m^2 = -gh_m\partial_y \bigg(b + \sum\limits_{k\geq j}h_k + \sum\limits_{k&lt;m}\frac{\rho_k}{\rho_m}h_k \bigg)
	\end{aligned}
\right.\]</p><p>where <span>$m = 1, 2, ..., M$</span> is the layer index and the unknown variables are the water height <span>$h$</span> and the velocities <span>$v1, v2$</span> in both spatial dimensions .  Furthermore, <span>$g$</span> denotes the gravitational constant, <span>$b(x)$</span> the bottom topography and <span>$\rho_m$</span> the m-th layer density, that must be chosen such that <span>$\rho_1 &lt; \rho_2 &lt; ... &lt; \rho_M$</span>, to ensure that different layers are ordered from top to bottom, with increasing density.</p><p>We use a specific formulation of the system, where the pressure term is reformulated as a nonconservative term, which has some benefits for the design of well-balanced schemes.</p><p>The additional quantity <span>$H_0$</span> is also available to store a reference value for the total water height that is useful to set initial conditions or test the &quot;lake-at-rest&quot; well-balancedness.</p><p>Also, there are two thresholds which prevent numerical problems as well as instabilities. The limiters are used in <a href="#TrixiShallowWater.PositivityPreservingLimiterShallowWater"><code>PositivityPreservingLimiterShallowWater</code></a> on the water height. <code>threshold_limiter</code> acts as a (small) shift on the initial condition and cutoff before the next time step, whereas <code>threshold_desingularization</code> is used in the velocity desingularization. A third <code>threshold_partially_wet</code> is applied on the water height to define &quot;partially wet&quot; elements in <a href="#TrixiShallowWater.IndicatorHennemannGassnerShallowWater"><code>IndicatorHennemannGassnerShallowWater</code></a>, that are then calculated with a pure FV method to ensure well-balancedness. For <code>Float64</code> no threshold needs to be passed, as default values are defined within the struct. For other number formats <code>threshold_desingularization</code> and <code>threshold_partially_wet</code> must be provided.</p><p>The bottom topography function <span>$b(x)$</span> is set inside the initial condition routine for a particular problem setup.</p><p>In addition to the unknowns, Trixi currently stores the bottom topography values at the approximation points despite being fixed in time. This is done for convenience of computing the bottom topography gradients on the fly during the approximation as well as computing auxiliary quantities like the total water height <span>$H$</span> or the entropy variables. This affects the implementation and use of these equations in various ways:</p><ul><li>The flux values corresponding to the bottom topography must be zero.</li><li>The bottom topography values must be included when defining initial conditions, boundary conditions or source terms.</li><li><a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.AnalysisCallback"><code>Trixi.AnalysisCallback</code></a> analyzes this variable.</li><li>Trixi&#39;s visualization tools will visualize the bottom topography by default.</li></ul><p>A good introduction for the MLSWE is available in Chapter 12 of the book:     - Benoit Cushman-Roisin (2011)<br/>      Introduction to geophyiscal fluid dynamics: physical and numerical aspects<br/>      <a href="https://www.sciencedirect.com/bookseries/international-geophysics/vol/101/suppl/C">https://www.sciencedirect.com/bookseries/international-geophysics/vol/101/suppl/C</a><br/>      ISBN: 978-0-12-088759-0</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_2d.jl#L8-L63">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.ShallowWaterTwoLayerEquations1D"><a class="docstring-binding" href="#TrixiShallowWater.ShallowWaterTwoLayerEquations1D"><code>TrixiShallowWater.ShallowWaterTwoLayerEquations1D</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ShallowWaterTwoLayerEquations1D(gravity, H0, rho_upper, rho_lower)</code></pre><p>Two-Layer Shallow Water equations (2LSWE) in one space dimension. The equations are given by</p><p class="math-container">\[\begin{alignat*}{4}
&amp;\frac{\partial}{\partial t}h_{upper}
&amp;&amp;+ \frac{\partial}{\partial x}\left(h_{upper} v_{1,upper}\right)
&amp;&amp;= 0 \\
&amp;\frac{\partial}{\partial t}\left(h_{upper}v_{1,upper}\right)
&amp;&amp;+ \frac{\partial}{\partial x}\left(h_{upper}v_{1,upper}^2 + \dfrac{gh_{upper}^2}{2}\right)
&amp;&amp;= -gh_{upper}\frac{\partial}{\partial x}\left(b+h_{lower}\right)\\
&amp;\frac{\partial}{\partial t}h_{lower}
&amp;&amp;+ \frac{\partial}{\partial x}\left(h_{lower}v_{1,lower}\right)
&amp;&amp;= 0 \\
&amp;\frac{\partial}{\partial t}\left(h_{lower}v_{1,lower}\right)
&amp;&amp;+ \frac{\partial}{\partial x}\left(h_{lower}v_{1,lower}^2 + \dfrac{gh_{lower}^2}{2}\right)
&amp;&amp;= -gh_{lower}\frac{\partial}{\partial x}\left(b+\dfrac{\rho_{upper}}{\rho_{lower}}h_{upper}\right).
\end{alignat*}\]</p><p>The unknown quantities of the 2LSWE are the water heights of the {lower} layer <span>$h_{lower}$</span> and the {upper} layer <span>$h_{upper}$</span> with respective velocities <span>$v_{1,upper}$</span> and <span>$v_{1,lower}$</span>. The gravitational acceleration is denoted by <code>g</code>, the layer densitites by <span>$\rho_{upper}$</span>and <span>$\rho_{lower}$</span> and the (possibly) variable bottom topography function <span>$b(x)$</span>. The conservative variable water height <span>$h_{lower}$</span> is measured from the bottom topography <span>$b$</span> and <span>$h_{upper}$</span> relative to <span>$h_{lower}$</span>, therefore one also defines the total water heights as <span>$H_{upper} = h_{upper} + h_{upper} + b$</span> and <span>$H_{lower} = h_{lower} + b$</span>.</p><p>The densities must be chosen such that <span>$\rho_{upper} &lt; \rho_{lower}$</span>, to make sure that the heavier fluid <span>$\rho_{lower}$</span> is in the bottom layer and the lighter fluid <span>$\rho_{upper}$</span> in the {upper} layer.</p><p>The additional quantity <span>$H_0$</span> is also available to store a reference value for the total water height that is useful to set initial conditions or test the &quot;lake-at-rest&quot; well-balancedness.</p><p>The bottom topography function <span>$b(x)$</span> is set inside the initial condition routine for a particular problem setup.</p><p>In addition to the unknowns, Trixi currently stores the bottom topography values at the approximation points despite being fixed in time. This is done for convenience of computing the bottom topography gradients on the fly during the approximation as well as computing auxiliary quantities like the total water height <span>$H$</span> or the entropy variables. This affects the implementation and use of these equations in various ways:</p><ul><li>The flux values corresponding to the bottom topography must be zero.</li><li>The bottom topography values must be included when defining initial conditions, boundary conditions or source terms.</li><li><a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.AnalysisCallback"><code>Trixi.AnalysisCallback</code></a> analyzes this variable.</li><li>Trixi&#39;s visualization tools will visualize the bottom topography by default.</li></ul><p>A good introduction for the 2LSWE is available in Chapter 12 of the book:</p><ul><li>Benoit Cushman-Roisin (2011)<br/>Introduction to geophyiscal fluid dynamics: physical and numerical aspects<br/><a href="https://www.sciencedirect.com/bookseries/international-geophysics/vol/101/suppl/C">https://www.sciencedirect.com/bookseries/international-geophysics/vol/101/suppl/C</a><br/>ISBN: 978-0-12-088759-0</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_1d.jl#L8-L60">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.ShallowWaterTwoLayerEquations2D"><a class="docstring-binding" href="#TrixiShallowWater.ShallowWaterTwoLayerEquations2D"><code>TrixiShallowWater.ShallowWaterTwoLayerEquations2D</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ShallowWaterTwoLayerEquations2D(gravity, H0, rho_upper, rho_lower)</code></pre><p>Two-Layer Shallow water equations (2LSWE) in two space dimension. The equations are given by</p><p class="math-container">\[\begin{alignat*}{8}
&amp;\frac{\partial}{\partial t}h_{upper}
&amp;&amp;+ \frac{\partial}{\partial x}\left(h_{upper} v_{1,upper}\right)
&amp;&amp;+ \frac{\partial}{\partial y}\left(h_{upper} v_{2,upper}\right)  \quad
&amp;&amp;= \quad 0 \\
&amp;\frac{\partial}{\partial t}\left(h_{upper} v_{1,upper}\right)
&amp;&amp;+ \frac{\partial}{\partial x}\left(h_{upper} v_{1,upper}^2 + \frac{gh_{upper}^2}{2}\right)
&amp;&amp;+ \frac{\partial}{\partial y}\left(h_{upper} v_{1,upper} v_{2,upper}\right) \quad
&amp;&amp;= -gh_{upper}\frac{\partial}{\partial x}\left(b+h_{lower}\right) \\
&amp;\frac{\partial}{\partial t}\left(h_{upper} v_{2,upper}\right)
&amp;&amp;+ \frac{\partial}{\partial x}\left(h_{upper} v_{1,upper} v_{2,upper}\right)
&amp;&amp;+ \frac{\partial}{\partial y}\left(h_{upper} v_{2,upper}^2 + \frac{gh_{upper}^2}{2}\right)
&amp;&amp;= -gh_{upper}\frac{\partial}{\partial y}\left(b+h_{lower}\right)\\
&amp;\frac{\partial}{\partial t}h_{lower}
&amp;&amp;+ \frac{\partial}{\partial x}\left(h_{lower} v_{1,lower}\right)
&amp;&amp;+ \frac{\partial}{\partial y}\left(h_{lower} v_{2,lower}\right)
&amp;&amp;= \quad 0 \\
&amp;\frac{\partial}{\partial t}\left(h_{lower} v_{1,lower}\right)
&amp;&amp;+ \frac{\partial}{\partial x}\left(h_{lower} v_{1,lower}^2 + \frac{gh_{lower}^2}{2}\right)
&amp;&amp;+ \frac{\partial}{\partial y}\left(h_{lower} v_{1,lower} v_{2,lower}\right)
&amp;&amp;= -gh_{lower}\frac{\partial}{\partial x}\left(b+\frac{\rho_{upper}}{\rho_{lower}} h_{upper}\right)\\
&amp;\frac{\partial}{\partial t}\left(h_{lower} v_{2,lower}\right)
&amp;&amp;+ \frac{\partial}{\partial x}\left(h_{lower} v_{1,lower} v_{2,lower}\right)
&amp;&amp;+ \frac{\partial}{\partial y}\left(h_{lower} v_{2,lower}^2 + \frac{gh_{lower}^2}{2}\right)
&amp;&amp;= -gh_{lower}\frac{\partial}{\partial y}\left(b+\frac{\rho_{upper}}{\rho_{lower}} h_{upper}\right)
\end{alignat*}\]</p><p>The unknown quantities of the 2LSWE are the water heights of the lower layer <span>$h_{lower}$</span> and the upper layer <span>$h_{upper}$</span> and the respective velocities in x-direction <span>$v_{1,lower}$</span> and <span>$v_{1,upper}$</span> and in y-direction <span>$v_{2,lower}$</span> and <span>$v_{2,upper}$</span>. The gravitational acceleration is denoted by <code>g</code>, the layer densitites by <span>$\rho_{upper}$</span>and <span>$\rho_{lower}$</span> and the (possibly) variable bottom topography function by <span>$b(x)$</span>. Conservative variable water height <span>$h_{lower}$</span> is measured from the bottom topography <span>$b$</span> and <span>$h_{upper}$</span> relative to <span>$h_{lower}$</span>, therefore one also defines the total water heights as <span>$H_{lower} = h_{lower} + b$</span> and <span>$H_{upper} = h_{upper} + h_{lower} + b$</span>.</p><p>The densities must be chosen such that <span>$\rho_{upper} &lt; \rho_{lower}$</span>, to make sure that the heavier fluid <span>$\rho_{lower}$</span> is in the bottom layer and the lighter fluid <span>$\rho_{upper}$</span> in the upper layer.</p><p>The additional quantity <span>$H_0$</span> is also available to store a reference value for the total water height that is useful to set initial conditions or test the &quot;lake-at-rest&quot; well-balancedness.</p><p>The bottom topography function <span>$b(x)$</span> is set inside the initial condition routine for a particular problem setup.</p><p>In addition to the unknowns, Trixi currently stores the bottom topography values at the approximation points despite being fixed in time. This is done for convenience of computing the bottom topography gradients on the fly during the approximation as well as computing auxiliary quantities like the total water height <span>$H$</span> or the entropy variables. This affects the implementation and use of these equations in various ways:</p><ul><li>The flux values corresponding to the bottom topography must be zero.</li><li>The bottom topography values must be included when defining initial conditions, boundary conditions or source terms.</li><li><a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.AnalysisCallback"><code>Trixi.AnalysisCallback</code></a> analyzes this variable.</li><li>Trixi&#39;s visualization tools will visualize the bottom topography by default.</li></ul><p>A good introduction for the 2LSWE is available in Chapter 12 of the book:</p><ul><li>Benoit Cushman-Roisin (2011)<br/>Introduction to geophyiscal fluid dynamics: physical and numerical aspects<br/><a href="https://www.sciencedirect.com/bookseries/international-geophysics/vol/101/suppl/C">https://www.sciencedirect.com/bookseries/international-geophysics/vol/101/suppl/C</a><br/>ISBN: 978-0-12-088759-0</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_2d.jl#L8-L74">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.ShieldsStressModel"><a class="docstring-binding" href="#TrixiShallowWater.ShieldsStressModel"><code>TrixiShallowWater.ShieldsStressModel</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">ShieldsStressModel(; m_1, m_2, m_3, k_1, k_2, k_3, theta_c, d_s)</code></pre><p>Create a Shields stress model to compute the sediment discharge <code>q_s</code> based on the generalized formulation from equation (1.2) in the given reference.</p><p>The choice of the real constants <code>m_1</code>, <code>m_2</code>, <code>m_3</code>, <code>k_1</code>, <code>k_2</code>, and <code>k_3</code> creates different models. For example, setting <code>m_1=0</code>, <code>m_2=1.5</code>, <code>m_3=0</code>, <code>k_1=8</code>, <code>k_2=1</code>, and <code>k_3=0</code> yields the sedimentation model of Meyer-Peter and Müller as given in <a href="#TrixiShallowWater.MeyerPeterMueller-Tuple{}"><code>MeyerPeterMueller</code></a> below. The Shields stress represents the ratio of agitating and stabilizing forces in the sediment bed where <code>theta_c</code> is the critical Shields stress for incipient motion and <code>d_s</code> is the mean diameter of the sediment grain size.</p><ul><li>E.D. Fernández-Nieto, T.M. de Luna, G. Narbona-Reina and J. de Dieu Zabsonré (2017)<br/>Formal deduction of the Saint-Venant–Exner model including arbitrarily sloping sediment beds and associated energy<br/><a href="https://doi.org/10.1051/m2an/2016018">DOI: 10.1051/m2an/2016018</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_exner_1d.jl#L29-L46">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.VelocityDesingularization"><a class="docstring-binding" href="#TrixiShallowWater.VelocityDesingularization"><code>TrixiShallowWater.VelocityDesingularization</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">VelocityDesingularization()</code></pre><p>A stage callback for desingularizing velocities in simulations with small water heights or densities.</p><p>This callback is designed to prevent division by very small water heights, which can lead to unphysical velocities and numerical instabilities. It is applied at each Runge-Kutta stage and modifies the conservative variables in-place to ensure that the velocity remains well-defined, even in nearly dry states.</p><p>The algorithm works by regularizing the velocity computation and enforcing a minimum water height threshold. For multi-layer systems, the procedure is applied to each layer individually. Thresholds to control the desingularization and the minimum water height can be set via  <code>threshold_desingularization</code> and <code>threshold_limiter</code> in the equations struct.</p><p>Details about the desingularization strategy can be found in Section 2.2 of the paper</p><ul><li>A. Kurganov, G. Petrova (2007) A second-order well-balanced positivity preserving central-upwind scheme for the Saint-Venant system <a href="https://dx.doi.org/10.4310/CMS.2007.v5.n1.a6">doi: 10.4310/CMS.2007.v5.n1.a6</a></li></ul><p>The specific implementation is based on Section 3.5 of the paper</p><ul><li>P. Ersing, S. Goldberg, A. Winters (2024) Entropy stable hydrostatic reconstruction schemes for shallow water systems <a href="https://doi.org/10.1016/j.jcp.2025.113802">doi: 10.1016/j.jcp.2025.113802</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/callbacks_stage/velocity_desingularization.jl#L8-L32">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.boundary_condition_slip_wall-Tuple{Any, AbstractVector, Any, Any, Any, ShallowWaterEquations2D}"><a class="docstring-binding" href="#Trixi.boundary_condition_slip_wall-Tuple{Any, AbstractVector, Any, Any, Any, ShallowWaterEquations2D}"><code>Trixi.boundary_condition_slip_wall</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">boundary_condition_slip_wall(u_inner, normal_direction, x, t, surface_flux_function,
                             equations::ShallowWaterEquations2D)</code></pre><p>Create a boundary state by reflecting the normal velocity component and keep the tangential velocity component unchanged. The boundary water height is taken from the internal value. For details see Section 9.2.5 of the book:</p><ul><li>Eleuterio F. Toro (2001) Shock-Capturing Methods for Free-Surface Shallow Flows 1st edition ISBN 0471987662</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L222-L233">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.boundary_condition_slip_wall-Tuple{Any, AbstractVector, Any, Any, Any, ShallowWaterMultiLayerEquations2D}"><a class="docstring-binding" href="#Trixi.boundary_condition_slip_wall-Tuple{Any, AbstractVector, Any, Any, Any, ShallowWaterMultiLayerEquations2D}"><code>Trixi.boundary_condition_slip_wall</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">boundary_condition_slip_wall(u_inner, normal_direction, x, t, surface_flux_function,
                             equations::ShallowWaterMultiLayerEquations2D)</code></pre><p>Create a boundary state by reflecting the normal velocity component and keep the tangential velocity component unchanged. The boundary water height is taken from the internal value. For details see Section 9.2.5 of the book:</p><ul><li>Eleuterio F. Toro (2001) Shock-Capturing Methods for Free-Surface Shallow Flows 1st edition ISBN 0471987662</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_2d.jl#L319-L330">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.boundary_condition_slip_wall-Tuple{Any, AbstractVector, Any, Any, Any, ShallowWaterTwoLayerEquations2D}"><a class="docstring-binding" href="#Trixi.boundary_condition_slip_wall-Tuple{Any, AbstractVector, Any, Any, Any, ShallowWaterTwoLayerEquations2D}"><code>Trixi.boundary_condition_slip_wall</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">boundary_condition_slip_wall(u_inner, normal_direction, x, t, surface_flux_function,
                             equations::ShallowWaterTwoLayerEquations2D)</code></pre><p>Create a boundary state by reflecting the normal velocity component and keep the tangential velocity component unchanged. The boundary water height is taken from the internal value.</p><p>For details see Section 9.2.5 of the book:</p><ul><li>Eleuterio F. Toro (2001) Shock-Capturing Methods for Free-Surface Shallow Flows 1st edition ISBN 0471987662</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_2d.jl#L225-L238">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.boundary_condition_slip_wall-Tuple{Any, Any, Any, Any, Any, Any, ShallowWaterEquations1D}"><a class="docstring-binding" href="#Trixi.boundary_condition_slip_wall-Tuple{Any, Any, Any, Any, Any, Any, ShallowWaterEquations1D}"><code>Trixi.boundary_condition_slip_wall</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">boundary_condition_slip_wall(u_inner, orientation_or_normal, x, t, surface_flux_function,
                              equations::ShallowWaterEquations1D)</code></pre><p>Create a boundary state by reflecting the normal velocity component and keep the tangential velocity component unchanged. The boundary water height is taken from the internal value.</p><p>For details see Section 9.2.5 of the book:</p><ul><li>Eleuterio F. Toro (2001) Shock-Capturing Methods for Free-Surface Shallow Flows 1st edition ISBN 0471987662</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L205-L218">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.boundary_condition_slip_wall-Tuple{Any, Any, Any, Any, Any, Any, ShallowWaterEquations2D}"><a class="docstring-binding" href="#Trixi.boundary_condition_slip_wall-Tuple{Any, Any, Any, Any, Any, Any, ShallowWaterEquations2D}"><code>Trixi.boundary_condition_slip_wall</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">boundary_condition_slip_wall(u_inner, orientation, direction, x, t,
                             surface_flux_function, equations::ShallowWaterEquations2D)</code></pre><p>Should be used together with <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.TreeMesh-Union%7BTuple%7BNDIMS%7D%2C%20Tuple%7BTuple%7BVararg%7BReal%2C%20NDIMS%7D%7D%2C%20Tuple%7BVararg%7BReal%2C%20NDIMS%7D%7D%7D%7D%20where%20NDIMS"><code>Trixi.TreeMesh</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L260-L265">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.boundary_condition_slip_wall-Tuple{Any, Any, Any, Any, Any, Any, ShallowWaterExnerEquations1D}"><a class="docstring-binding" href="#Trixi.boundary_condition_slip_wall-Tuple{Any, Any, Any, Any, Any, Any, ShallowWaterExnerEquations1D}"><code>Trixi.boundary_condition_slip_wall</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">boundary_condition_slip_wall(u_inner, orientation_or_normal, x, t, surface_flux_function,
                              equations::ShallowWaterExnerEquations1D)</code></pre><p>Create a boundary state by reflecting the normal velocity component and keep the tangential velocity component unchanged. The boundary water height is taken from the internal value.</p><p>For details see Section 9.2.5 of the book:</p><ul><li>Eleuterio F. Toro (2001)<br/>Shock-Capturing Methods for Free-Surface Shallow Flows<br/>1st edition<br/>ISBN 0471987662</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_exner_1d.jl#L179-L192">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.boundary_condition_slip_wall-Tuple{Any, Any, Any, Any, Any, Any, ShallowWaterMultiLayerEquations1D}"><a class="docstring-binding" href="#Trixi.boundary_condition_slip_wall-Tuple{Any, Any, Any, Any, Any, Any, ShallowWaterMultiLayerEquations1D}"><code>Trixi.boundary_condition_slip_wall</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">boundary_condition_slip_wall(u_inner, orientation_or_normal, x, t, surface_flux_function,
                             equations::ShallowWaterMultiLayerEquations1D)</code></pre><p>Create a boundary state by reflecting the normal velocity component and keep the tangential velocity component unchanged. The boundary water height is taken from the internal value.</p><p>For details see Section 9.2.5 of the book:</p><ul><li>Eleuterio F. Toro (2001) Shock-Capturing Methods for Free-Surface Shallow Flows 1st edition ISBN 0471987662</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_1d.jl#L243-L256">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.boundary_condition_slip_wall-Tuple{Any, Any, Any, Any, Any, Any, ShallowWaterMultiLayerEquations2D}"><a class="docstring-binding" href="#Trixi.boundary_condition_slip_wall-Tuple{Any, Any, Any, Any, Any, Any, ShallowWaterMultiLayerEquations2D}"><code>Trixi.boundary_condition_slip_wall</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">boundary_condition_slip_wall(u_inner, orientation, direction, x, t,
                             surface_flux_function, equations::ShallowWaterMultiLayerEquations2D)</code></pre><p>Should be used together with <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.TreeMesh-Union%7BTuple%7BNDIMS%7D%2C%20Tuple%7BTuple%7BVararg%7BReal%2C%20NDIMS%7D%7D%2C%20Tuple%7BVararg%7BReal%2C%20NDIMS%7D%7D%7D%7D%20where%20NDIMS"><code>Trixi.TreeMesh</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_2d.jl#L363-L368">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.boundary_condition_slip_wall-Tuple{Any, Any, Any, Any, Any, Any, ShallowWaterTwoLayerEquations1D}"><a class="docstring-binding" href="#Trixi.boundary_condition_slip_wall-Tuple{Any, Any, Any, Any, Any, Any, ShallowWaterTwoLayerEquations1D}"><code>Trixi.boundary_condition_slip_wall</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">boundary_condition_slip_wall(u_inner, orientation_or_normal, x, t, surface_flux_function,
                             equations::ShallowWaterTwoLayerEquations1D)</code></pre><p>Create a boundary state by reflecting the normal velocity component and keep the tangential velocity component unchanged. The boundary water height is taken from the internal value.</p><p>For details see Section 9.2.5 of the book:</p><ul><li>Eleuterio F. Toro (2001) Shock-Capturing Methods for Free-Surface Shallow Flows 1st edition ISBN 0471987662</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_1d.jl#L161-L174">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.flux_chan_etal-Tuple{Any, Any, Integer, ShallowWaterEquationsQuasi1D}"><a class="docstring-binding" href="#Trixi.flux_chan_etal-Tuple{Any, Any, Integer, ShallowWaterEquationsQuasi1D}"><code>Trixi.flux_chan_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_chan_etal(u_ll, u_rr, orientation,
               equations::ShallowWaterEquationsQuasi1D)</code></pre><p>Total energy conservative (mathematical entropy for quasi 1D shallow water equations) split form. When the bottom topography is nonzero this scheme will be well-balanced when used as a <code>volume_flux</code>. The <code>surface_flux</code> should still use, e.g., <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.FluxPlusDissipation"><code>FluxPlusDissipation(flux_chan_etal, DissipationLocalLaxFriedrichs())</code></a>.</p><p>Further details are available in the paper:</p><ul><li>Jesse Chan, Khemraj Shukla, Xinhui Wu, Ruofeng Liu, Prani Nalluri (2023)  High order entropy stable schemes for the quasi-one-dimensional shallow water and compressible Euler equations <a href="https://doi.org/10.48550/arXiv.2307.12089">DOI: 10.48550/arXiv.2307.12089</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_quasi_1d.jl#L183-L196">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.flux_fjordholm_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><a class="docstring-binding" href="#Trixi.flux_fjordholm_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>Trixi.flux_fjordholm_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_fjordholm_etal(u_ll, u_rr, orientation,
                    equations::ShallowWaterEquations1D)</code></pre><p>Total energy conservative (mathematical entropy for shallow water equations). When the bottom topography is nonzero this should only be used as a surface flux otherwise the scheme will not be well-balanced. For well-balancedness in the volume flux use <a href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_wintermeyer_etal</code></a>.</p><p>Details are available in Eq. (4.1) in the paper:</p><ul><li>Ulrik S. Fjordholm, Siddhartha Mishr and Eitan Tadmor (2011) Well-balanced and energy stable schemes for the shallow water equations with discontinuous topography <a href="https://doi.org/10.1016/j.jcp.2011.03.042">DOI: 10.1016/j.jcp.2011.03.042</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L567-L579">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.flux_fjordholm_etal-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><a class="docstring-binding" href="#Trixi.flux_fjordholm_etal-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><code>Trixi.flux_fjordholm_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_fjordholm_etal(u_ll, u_rr, orientation_or_normal_direction,
                    equations::ShallowWaterEquations2D)</code></pre><p>Total energy conservative (mathematical entropy for shallow water equations). When the bottom topography is nonzero this should only be used as a surface flux otherwise the scheme will not be well-balanced. For well-balancedness in the volume flux use <a href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_wintermeyer_etal</code></a>.</p><p>Details are available in Eq. (4.1) in the paper:</p><ul><li>Ulrik S. Fjordholm, Siddhartha Mishr and Eitan Tadmor (2011) Well-balanced and energy stable schemes for the shallow water equations with discontinuous topography <a href="https://doi.org/10.1016/j.jcp.2011.03.042">DOI: 10.1016/j.jcp.2011.03.042</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L995-L1007">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.flux_nonconservative_chan_etal-Tuple{Any, Any, Integer, ShallowWaterEquationsQuasi1D}"><a class="docstring-binding" href="#Trixi.flux_nonconservative_chan_etal-Tuple{Any, Any, Integer, ShallowWaterEquationsQuasi1D}"><code>Trixi.flux_nonconservative_chan_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_chan_etal(u_ll, u_rr, orientation::Integer,
                               equations::ShallowWaterEquationsQuasi1D)
flux_nonconservative_chan_etal(u_ll, u_rr, normal_direction::AbstractVector,
                               equations::ShallowWaterEquationsQuasi1D)    
flux_nonconservative_chan_etal(u_ll, u_rr, 
                               normal_ll::AbstractVector, normal_rr::AbstractVector,
                               equations::ShallowWaterEquationsQuasi1D)</code></pre><p>Non-symmetric two-point volume flux discretizing the nonconservative (source) term that contains the gradient of the bottom topography <a href="#TrixiShallowWater.ShallowWaterEquationsQuasi1D"><code>ShallowWaterEquationsQuasi1D</code></a>  and the channel width.</p><p>Further details are available in the paper:</p><ul><li>Jesse Chan, Khemraj Shukla, Xinhui Wu, Ruofeng Liu, Prani Nalluri (2023)   High order entropy stable schemes for the quasi-one-dimensional   shallow water and compressible Euler equations   <a href="https://doi.org/10.48550/arXiv.2307.12089">DOI: 10.48550/arXiv.2307.12089</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_quasi_1d.jl#L133-L151">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.flux_nonconservative_fjordholm_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><a class="docstring-binding" href="#Trixi.flux_nonconservative_fjordholm_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>Trixi.flux_nonconservative_fjordholm_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_fjordholm_etal(u_ll, u_rr, orientation::Integer,
                                    equations::ShallowWaterEquations1D)</code></pre><p>Non-symmetric two-point surface flux discretizing the nonconservative (source) term of that contains the gradient of the bottom topography <a href="#TrixiShallowWater.ShallowWaterEquations1D"><code>ShallowWaterEquations1D</code></a>.</p><p>This flux can be used together with <a href="#Trixi.flux_fjordholm_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_fjordholm_etal</code></a> at interfaces to ensure entropy conservation and well-balancedness.</p><p>Further details for the original finite volume formulation are available in</p><ul><li>Ulrik S. Fjordholm, Siddhartha Mishr and Eitan Tadmor (2011) Well-balanced and energy stable schemes for the shallow water equations with discontinuous topography <a href="https://doi.org/10.1016/j.jcp.2011.03.042">DOI: 10.1016/j.jcp.2011.03.042</a></li></ul><p>and for curvilinear 2D case in the paper:</p><ul><li>Niklas Wintermeyer, Andrew R. Winters, Gregor J. Gassner and David A. Kopriva (2017) An entropy stable nodal discontinuous Galerkin method for the two dimensional shallow water equations on unstructured curvilinear meshes with discontinuous bathymetry <a href="https://doi.org/10.1016/j.jcp.2017.03.036">DOI: 10.1016/j.jcp.2017.03.036</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L451-L470">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.flux_nonconservative_fjordholm_etal-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><a class="docstring-binding" href="#Trixi.flux_nonconservative_fjordholm_etal-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><code>Trixi.flux_nonconservative_fjordholm_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_fjordholm_etal(u_ll, u_rr, orientation::Integer,
                                    equations::ShallowWaterEquations2D)
flux_nonconservative_fjordholm_etal(u_ll, u_rr,
                                    normal_direction::AbstractVector,
                                    equations::ShallowWaterEquations2D)</code></pre><p>Non-symmetric two-point surface flux discretizing the nonconservative (source) term of that contains the gradient of the bottom topography <a href="#TrixiShallowWater.ShallowWaterEquations2D"><code>ShallowWaterEquations2D</code></a>.</p><p>This flux can be used together with <a href="#Trixi.flux_fjordholm_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_fjordholm_etal</code></a> at interfaces to ensure entropy conservation and well-balancedness.</p><p>Further details for the original finite volume formulation are available in</p><ul><li>Ulrik S. Fjordholm, Siddhartha Mishra and Eitan Tadmor (2011) Well-balanced and energy stable schemes for the shallow water equations with discontinuous topography <a href="https://doi.org/10.1016/j.jcp.2011.03.042">DOI: 10.1016/j.jcp.2011.03.042</a></li></ul><p>and for curvilinear 2D case in the paper:</p><ul><li>Niklas Wintermeyer, Andrew R. Winters, Gregor J. Gassner and David A. Kopriva (2017) An entropy stable nodal discontinuous Galerkin method for the two dimensional shallow water equations on unstructured curvilinear meshes with discontinuous bathymetry <a href="https://doi.org/10.1016/j.jcp.2017.03.036">DOI: 10.1016/j.jcp.2017.03.036</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L681-L703">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.flux_nonconservative_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><a class="docstring-binding" href="#Trixi.flux_nonconservative_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>Trixi.flux_nonconservative_wintermeyer_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_wintermeyer_etal(u_ll, u_rr, orientation::Integer,
                                      equations::ShallowWaterEquations1D)</code></pre><p>Non-symmetric two-point volume flux discretizing the nonconservative (source) term that contains the gradient of the bottom topography <a href="#TrixiShallowWater.ShallowWaterEquations1D"><code>ShallowWaterEquations1D</code></a>.</p><p>Gives entropy conservation and well-balancedness on both the volume and surface when combined with <a href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_wintermeyer_etal</code></a>.</p><p>Further details are available in the papers:</p><ul><li>Niklas Wintermeyer, Andrew R. Winters, Gregor J. Gassner and David A. Kopriva (2017) An entropy stable nodal discontinuous Galerkin method for the two dimensional shallow water equations on unstructured curvilinear meshes with discontinuous bathymetry <a href="https://doi.org/10.1016/j.jcp.2017.03.036">DOI: 10.1016/j.jcp.2017.03.036</a></li><li>Patrick Ersing, Andrew R. Winters (2023) An entropy stable discontinuous Galerkin method for the two-layer shallow water equations on curvilinear meshes <a href="https://doi.org/10.48550/arXiv.2306.12699">DOI: 10.48550/arXiv.2306.12699</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L418-L437">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.flux_nonconservative_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><a class="docstring-binding" href="#Trixi.flux_nonconservative_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><code>Trixi.flux_nonconservative_wintermeyer_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_wintermeyer_etal(u_ll, u_rr, orientation::Integer,
                                      equations::ShallowWaterEquations2D)
flux_nonconservative_wintermeyer_etal(u_ll, u_rr,
                                      normal_direction::AbstractVector,
                                      equations::ShallowWaterEquations2D)</code></pre><p>Non-symmetric two-point volume flux discretizing the nonconservative (source) term that contains the gradient of the bottom topography <a href="#TrixiShallowWater.ShallowWaterEquations2D"><code>ShallowWaterEquations2D</code></a>.</p><p>For the <code>surface_flux</code> either <a href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_wintermeyer_etal</code></a> or <a href="#Trixi.flux_fjordholm_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_fjordholm_etal</code></a> can be used to ensure well-balancedness and entropy conservation.</p><p>Further details are available in the papers:</p><ul><li>Niklas Wintermeyer, Andrew R. Winters, Gregor J. Gassner and David A. Kopriva (2017) An entropy stable nodal discontinuous Galerkin method for the two dimensional shallow water equations on unstructured curvilinear meshes with discontinuous bathymetry <a href="https://doi.org/10.1016/j.jcp.2017.03.036">DOI: 10.1016/j.jcp.2017.03.036</a></li><li>Patrick Ersing, Andrew R. Winters (2023) An entropy stable discontinuous Galerkin method for the two-layer shallow water equations on curvilinear meshes <a href="https://doi.org/10.48550/arXiv.2306.12699">DOI: 10.48550/arXiv.2306.12699</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L628-L650">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><a class="docstring-binding" href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>Trixi.flux_wintermeyer_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_wintermeyer_etal(u_ll, u_rr, orientation,
                      equations::ShallowWaterEquations1D)</code></pre><p>Total energy conservative (mathematical entropy for shallow water equations) split form. When the bottom topography is nonzero this scheme will be well-balanced when used as a <code>volume_flux</code>. For the <code>surface_flux</code> either <a href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_wintermeyer_etal</code></a> or <a href="#Trixi.flux_fjordholm_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_fjordholm_etal</code></a> can be used to ensure well-balancedness and entropy conservation.</p><p>Further details are available in Theorem 1 of the paper:</p><ul><li>Niklas Wintermeyer, Andrew R. Winters, Gregor J. Gassner and David A. Kopriva (2017) An entropy stable nodal discontinuous Galerkin method for the two dimensional shallow water equations on unstructured curvilinear meshes with discontinuous bathymetry <a href="https://doi.org/10.1016/j.jcp.2017.03.036">DOI: 10.1016/j.jcp.2017.03.036</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L600-L614">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><a class="docstring-binding" href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><code>Trixi.flux_wintermeyer_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_wintermeyer_etal(u_ll, u_rr, orientation_or_normal_direction,
                      equations::ShallowWaterEquations2D)</code></pre><p>Total energy conservative (mathematical entropy for shallow water equations) split form. When the bottom topography is nonzero this scheme will be well-balanced when used as a <code>volume_flux</code>. For the <code>surface_flux</code> either <a href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_wintermeyer_etal</code></a> or <a href="#Trixi.flux_fjordholm_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_fjordholm_etal</code></a> can be used to ensure well-balancedness and entropy conservation.</p><p>Further details are available in Theorem 1 of the paper:</p><ul><li>Niklas Wintermeyer, Andrew R. Winters, Gregor J. Gassner and David A. Kopriva (2017) An entropy stable nodal discontinuous Galerkin method for the two dimensional shallow water equations on unstructured curvilinear meshes with discontinuous bathymetry <a href="https://doi.org/10.1016/j.jcp.2017.03.036">DOI: 10.1016/j.jcp.2017.03.036</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L1063-L1077">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterTwoLayerEquations1D}"><a class="docstring-binding" href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterTwoLayerEquations1D}"><code>Trixi.flux_wintermeyer_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_wintermeyer_etal(u_ll, u_rr, orientation,
                      equations::ShallowWaterTwoLayerEquations1D)</code></pre><p>Total energy conservative (mathematical entropy for two-layer shallow water equations) split form. When the bottom topography is nonzero this scheme will be well-balanced when used with the  nonconservative <a href="#TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterExnerEquations1D}"><code>flux_nonconservative_ersing_etal</code></a>. To obtain the flux for the two-layer shallow water equations the flux that is described in the paper for the normal shallow  water equations is used within each layer.</p><p>Further details are available in Theorem 1 of the paper:</p><ul><li>Niklas Wintermeyer, Andrew R. Winters, Gregor J. Gassner and David A. Kopriva (2017) An entropy stable nodal discontinuous Galerkin method for the two dimensional shallow water equations on unstructured curvilinear meshes with discontinuous bathymetry <a href="https://doi.org/10.1016/j.jcp.2017.03.036">DOI: 10.1016/j.jcp.2017.03.036</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_1d.jl#L268-L283">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterTwoLayerEquations2D}"><a class="docstring-binding" href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterTwoLayerEquations2D}"><code>Trixi.flux_wintermeyer_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_wintermeyer_etal(u_ll, u_rr, orientation,
                      equations::ShallowWaterTwoLayerEquations2D)
flux_wintermeyer_etal(u_ll, u_rr,
                      normal_direction::AbstractVector,
                      equations::ShallowWaterTwoLayerEquations2D)</code></pre><p>Total energy conservative (mathematical entropy for two-layer shallow water equations) split form. When the bottom topography is nonzero this scheme will be well-balanced when used with the  nonconservative <a href="#TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterExnerEquations1D}"><code>flux_nonconservative_ersing_etal</code></a>. To obtain the flux for the two-layer shallow water equations the flux that is described in the paper for the normal shallow  water equations is used within each layer.</p><p>Further details are available in Theorem 1 of the paper:</p><ul><li>Niklas Wintermeyer, Andrew R. Winters, Gregor J. Gassner and David A. Kopriva (2017) An entropy stable nodal discontinuous Galerkin method for the two dimensional shallow water equations on unstructured curvilinear meshes with discontinuous bathymetry <a href="https://doi.org/10.1016/j.jcp.2017.03.036">DOI: 10.1016/j.jcp.2017.03.036</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_2d.jl#L414-L432">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.get_boundary_outer_state-Tuple{Any, Any, typeof(Trixi.boundary_condition_slip_wall), Any, Union{Trixi.P4estMesh{2}, Trixi.UnstructuredMesh2D}, ShallowWaterMultiLayerEquations2D, Any, Any, Vararg{Any}}"><a class="docstring-binding" href="#Trixi.get_boundary_outer_state-Tuple{Any, Any, typeof(Trixi.boundary_condition_slip_wall), Any, Union{Trixi.P4estMesh{2}, Trixi.UnstructuredMesh2D}, ShallowWaterMultiLayerEquations2D, Any, Any, Vararg{Any}}"><code>Trixi.get_boundary_outer_state</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">Trixi.get_boundary_outer_state(u_inner, t,
                               boundary_condition::typeof(boundary_condition_slip_wall),
                               normal_direction,
                               mesh::Union{UnstructuredMesh2D, P4estMesh{2}},
                               equations::ShallowWaterMultiLayerEquations2D,
                               dg, cache, indices...)

For subcell limiting, the calculation of local bounds for non-periodic domains requires the boundary
outer state. This function returns the boundary value for [`Trixi.boundary_condition_slip_wall`](@extref)
for the [`ShallowWaterMultiLayerEquations2D`](@ref) at time `t` and for node with spatial 
indices `indices` at the boundary with meshes using a `normal_direction`.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_2d.jl#L401-L413">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations1D}"><a class="docstring-binding" href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations1D}"><code>Trixi.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::ShallowWaterEquations1D)</code></pre><p>A smooth initial condition used for convergence tests in combination with <a href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterEquations2D}"><code>source_terms_convergence_test</code></a> (and <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.BoundaryConditionDirichlet"><code>Trixi.BoundaryConditionDirichlet</code></a> in non-periodic domains).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L122-L128">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations2D}"><a class="docstring-binding" href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations2D}"><code>Trixi.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::ShallowWaterEquations2D)</code></pre><p>A smooth initial condition used for convergence tests in combination with <a href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterEquations2D}"><code>source_terms_convergence_test</code></a> (and <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.BoundaryConditionDirichlet"><code>Trixi.BoundaryConditionDirichlet</code></a> in non-periodic domains).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L122-L128">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquationsQuasi1D}"><a class="docstring-binding" href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquationsQuasi1D}"><code>Trixi.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::ShallowWaterEquationsQuasi1D)</code></pre><p>A smooth initial condition used for convergence tests in combination with <a href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterEquations2D}"><code>source_terms_convergence_test</code></a> (and <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.BoundaryConditionDirichlet"><code>BoundaryConditionDirichlet(initial_condition_convergence_test)</code></a> in non-periodic domains).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_quasi_1d.jl#L65-L71">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterExnerEquations1D}"><a class="docstring-binding" href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterExnerEquations1D}"><code>Trixi.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::ShallowWaterExnerEquations1D)</code></pre><p>A smooth initial condition used for convergence tests in combination with <a href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterEquations2D}"><code>Trixi.source_terms_convergence_test</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_exner_1d.jl#L224-L229">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterMultiLayerEquations1D}"><a class="docstring-binding" href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterMultiLayerEquations1D}"><code>Trixi.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::ShallowWaterMultiLayerEquations1D)</code></pre><p>A smooth initial condition for a three-layer configuration used for convergence tests in combination with <a href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterEquations2D}"><code>source_terms_convergence_test</code></a> (and <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.BoundaryConditionDirichlet"><code>Trixi.BoundaryConditionDirichlet</code></a> in non-periodic domains).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_1d.jl#L162-L168">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterMultiLayerEquations2D}"><a class="docstring-binding" href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterMultiLayerEquations2D}"><code>Trixi.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::ShallowWaterMultiLayerEquations2D)</code></pre><p>A smooth initial condition for a three-layer configuration used for convergence tests in combination with <a href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterEquations2D}"><code>source_terms_convergence_test</code></a> (and <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.BoundaryConditionDirichlet"><code>Trixi.BoundaryConditionDirichlet</code></a> in non-periodic domains).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_2d.jl#L164-L170">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterTwoLayerEquations1D}"><a class="docstring-binding" href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterTwoLayerEquations1D}"><code>Trixi.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::ShallowWaterTwoLayerEquations1D)</code></pre><p>A smooth initial condition used for convergence tests in combination with <a href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterEquations2D}"><code>source_terms_convergence_test</code></a> (and <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.BoundaryConditionDirichlet"><code>Trixi.BoundaryConditionDirichlet</code></a> in non-periodic domains).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_1d.jl#L101-L107">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterTwoLayerEquations2D}"><a class="docstring-binding" href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterTwoLayerEquations2D}"><code>Trixi.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::ShallowWaterTwoLayerEquations2D)</code></pre><p>A smooth initial condition used for convergence tests in combination with <a href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterEquations2D}"><code>source_terms_convergence_test</code></a>. Constants must be set to <span>$rho_{upper} = 0.9$</span>, <span>$rho_{lower} = 1.0$</span>, <span>$g = 10.0$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_2d.jl#L113-L119">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.initial_condition_weak_blast_wave-Tuple{Any, Any, ShallowWaterEquations1D}"><a class="docstring-binding" href="#Trixi.initial_condition_weak_blast_wave-Tuple{Any, Any, ShallowWaterEquations1D}"><code>Trixi.initial_condition_weak_blast_wave</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">initial_condition_weak_blast_wave(x, t, equations::ShallowWaterEquations1D)</code></pre><p>A weak blast wave discontinuity useful for testing, e.g., total energy conservation. Note for the shallow water equations to the total energy acts as a mathematical entropy function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L184-L189">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.initial_condition_weak_blast_wave-Tuple{Any, Any, ShallowWaterEquations2D}"><a class="docstring-binding" href="#Trixi.initial_condition_weak_blast_wave-Tuple{Any, Any, ShallowWaterEquations2D}"><code>Trixi.initial_condition_weak_blast_wave</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">initial_condition_weak_blast_wave(x, t, equations::ShallowWaterEquations2D)</code></pre><p>A weak blast wave discontinuity useful for testing, e.g., total energy conservation. Note for the shallow water equations to the total energy acts as a mathematical entropy function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L196-L201">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterEquations2D}"><a class="docstring-binding" href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterEquations2D}"><code>Trixi.source_terms_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">source_terms_convergence_test(u, x, t, equations::ShallowWaterEquations2D)</code></pre><p>Source terms used for convergence tests in combination with <a href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations1D}"><code>initial_condition_convergence_test</code></a> (and <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.BoundaryConditionDirichlet"><code>Trixi.BoundaryConditionDirichlet</code></a> in non-periodic domains).</p><p>This manufactured solution source term is specifically designed for the bottom topography function <code>b(x,y) = 2 + 0.5 * sin(sqrt(2)*pi*x) + 0.5 * sin(sqrt(2)*pi*y)</code> as defined in <a href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations1D}"><code>initial_condition_convergence_test</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L147-L157">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterEquationsQuasi1D}"><a class="docstring-binding" href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterEquationsQuasi1D}"><code>Trixi.source_terms_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">source_terms_convergence_test(u, x, t, equations::ShallowWaterEquationsQuasi1D)</code></pre><p>Source terms used for convergence tests in combination with <a href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations1D}"><code>initial_condition_convergence_test</code></a> (and <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.BoundaryConditionDirichlet"><code>BoundaryConditionDirichlet(initial_condition_convergence_test)</code></a> in non-periodic domains).</p><p>This manufactured solution source term is specifically designed for the bottom topography function <code>b(x) = 0.2 - 0.05 * sinpi(sqrt(2) * x[1])</code> and channel width &#39;a(x)= 1 + 0.1 * cospi(sqrt(2) * x[1])&#39; as defined in <a href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations1D}"><code>initial_condition_convergence_test</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_quasi_1d.jl#L85-L95">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterMultiLayerEquations1D}"><a class="docstring-binding" href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterMultiLayerEquations1D}"><code>Trixi.source_terms_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">source_terms_convergence_test(u, x, t, equations::ShallowWaterMultiLayerEquations1D)</code></pre><p>Source terms used for convergence tests with a three-layer configuration in combination with <a href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations1D}"><code>initial_condition_convergence_test</code></a> (and <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.BoundaryConditionDirichlet"><code>Trixi.BoundaryConditionDirichlet</code></a> in non-periodic domains).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_1d.jl#L190-L197">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterMultiLayerEquations2D}"><a class="docstring-binding" href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterMultiLayerEquations2D}"><code>Trixi.source_terms_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">source_terms_convergence_test(u, x, t, equations::ShallowWaterMultiLayerEquations2D)</code></pre><p>Source terms used for convergence tests with a three-layer configuration in combination with <a href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations1D}"><code>initial_condition_convergence_test</code></a> (and <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.BoundaryConditionDirichlet"><code>Trixi.BoundaryConditionDirichlet</code></a> in non-periodic domains).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_2d.jl#L193-L200">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterTwoLayerEquations1D}"><a class="docstring-binding" href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterTwoLayerEquations1D}"><code>Trixi.source_terms_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">source_terms_convergence_test(u, x, t, equations::ShallowWaterTwoLayerEquations1D)</code></pre><p>Source terms used for convergence tests in combination with <a href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations1D}"><code>initial_condition_convergence_test</code></a> (and <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.BoundaryConditionDirichlet"><code>Trixi.BoundaryConditionDirichlet</code></a> in non-periodic domains).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_1d.jl#L122-L129">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterTwoLayerEquations2D}"><a class="docstring-binding" href="#Trixi.source_terms_convergence_test-Tuple{Any, Any, Any, ShallowWaterTwoLayerEquations2D}"><code>Trixi.source_terms_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">source_terms_convergence_test(u, x, t, equations::ShallowWaterTwoLayerEquations2D)</code></pre><p>Source terms used for convergence tests in combination with <a href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations1D}"><code>initial_condition_convergence_test</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_2d.jl#L137-L142">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.source_terms_convergence_test-Union{Tuple{S}, Tuple{T}, Tuple{Any, Any, Any, ShallowWaterExnerEquations1D{T, S, GrassModel{T}}}} where {T, S}"><a class="docstring-binding" href="#Trixi.source_terms_convergence_test-Union{Tuple{S}, Tuple{T}, Tuple{Any, Any, Any, ShallowWaterExnerEquations1D{T, S, GrassModel{T}}}} where {T, S}"><code>Trixi.source_terms_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">source_terms_convergence_test(u, x, t, equations::ShallowWaterExnerEquations1D{T, S, GrassModel{T}}) where {T, S}</code></pre><p>Source terms used for convergence tests in combination with <a href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations1D}"><code>Trixi.initial_condition_convergence_test</code></a> when using the the <a href="#TrixiShallowWater.GrassModel"><code>GrassModel</code></a> model.</p><p>To use this source term the equations must be set to:</p><pre><code class="language-julia hljs">equations = ShallowWaterExnerEquations1D(gravity = 10.0, rho_f = 0.5,
                                            rho_s = 1.0, porosity = 0.5,
                                            friction = ManningFriction(n = 0.0),
                                            sediment_model = GrassModel(A_g = 0.01)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_exner_1d.jl#L241-L254">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Trixi.source_terms_convergence_test-Union{Tuple{S}, Tuple{T}, Tuple{Any, Any, Any, ShallowWaterExnerEquations1D{T, S, ShieldsStressModel{T}}}} where {T, S}"><a class="docstring-binding" href="#Trixi.source_terms_convergence_test-Union{Tuple{S}, Tuple{T}, Tuple{Any, Any, Any, ShallowWaterExnerEquations1D{T, S, ShieldsStressModel{T}}}} where {T, S}"><code>Trixi.source_terms_convergence_test</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">source_terms_convergence_test(u, x, t, equations::ShallowWaterExnerEquations1D{T, S, ShieldsStressModel{T}}) where {T, S}</code></pre><p>Source terms used for convergence tests in combination with <a href="#Trixi.initial_condition_convergence_test-Tuple{Any, Any, ShallowWaterEquations1D}"><code>Trixi.initial_condition_convergence_test</code></a> when using the <a href="#TrixiShallowWater.MeyerPeterMueller-Tuple{}"><code>MeyerPeterMueller</code></a> model.</p><p>To use this source term the equations must be set to:</p><pre><code class="language-julia hljs">equations = ShallowWaterExnerEquations1D(gravity = 10.0, rho_f = 0.5,
                                         rho_s = 1.0, porosity = 0.5,
                                         friction = ManningFriction(n = 0.01),
                                         sediment_model = MeyerPeterMueller(theta_c = 0.0,
                                                                            d_s = 1e-3))</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_exner_1d.jl#L276-L291">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.MeyerPeterMueller-Tuple{}"><a class="docstring-binding" href="#TrixiShallowWater.MeyerPeterMueller-Tuple{}"><code>TrixiShallowWater.MeyerPeterMueller</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">MeyerPeterMueller(; theta_c, d_s)</code></pre><p>Creates a Meyer-Peter-Mueller model to compute the sediment discharge <code>q_s</code> with the critical Shields stress <code>theta_c</code> and the grain diameter <code>d_s</code>.</p><p>An overview of different formulations to compute the sediment discharge can be found in:</p><ul><li>M.J. Castro Díaz, E.D. Fernández-Nieto, A.M. Ferreiro (2008)<br/>Sediment transport models in Shallow Water equations and numerical approach by high order finite volume methods<br/><a href="https://doi.org/10.1016/j.compfluid.2007.07.017">DOI:10.1016/j.compfluid.2007.07.017</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_exner_1d.jl#L88-L99">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.calc_wavespeed_roe-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.calc_wavespeed_roe-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>TrixiShallowWater.calc_wavespeed_roe</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">calc_wavespeed_roe(u_ll, u_rr, direction::Integer,
                   equations::ShallowWaterEquations1D)</code></pre><p>Calculate Roe-averaged velocity <code>v_roe</code> and wavespeed <code>c_roe = sqrt{g * h_roe}</code> See for instance equation (62) in</p><ul><li>Paul A. Ullrich, Christiane Jablonowski, and Bram van Leer (2010) High-order finite-volume methods for the shallow-water equations on the sphere <a href="https://doi.org/10.1016/j.jcp.2010.04.044">DOI: 10.1016/j.jcp.2010.04.044</a></li></ul><p>Or equation (9.17) in <a href="https://metaphor.ethz.ch/x/2019/hs/401-4671-00L/literature/mishra_hyperbolic_pdes.pdf">this lecture notes</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L937-L947">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.calc_wavespeed_roe-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><a class="docstring-binding" href="#TrixiShallowWater.calc_wavespeed_roe-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><code>TrixiShallowWater.calc_wavespeed_roe</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">calc_wavespeed_roe(u_ll, u_rr, direction::Integer,
                   equations::ShallowWaterEquations2D)</code></pre><p>Calculate Roe-averaged velocity <code>v_roe</code> and wavespeed <code>c_roe = sqrt{g * h_roe}</code> depending on direction. See for instance equation (62) in</p><ul><li>Paul A. Ullrich, Christiane Jablonowski, and Bram van Leer (2010) High-order finite-volume methods for the shallow-water equations on the sphere <a href="https://doi.org/10.1016/j.jcp.2010.04.044">DOI: 10.1016/j.jcp.2010.04.044</a></li></ul><p>Or <a href="https://faculty.washington.edu/rjl/classes/am574w2011/slides/am574lecture20nup3.pdf">this slides</a>, slides 8 and 9.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L1537-L1548">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.dissipation_roe-Tuple{Any, Any, AbstractVector, ShallowWaterEquations2D}"><a class="docstring-binding" href="#TrixiShallowWater.dissipation_roe-Tuple{Any, Any, AbstractVector, ShallowWaterEquations2D}"><code>TrixiShallowWater.dissipation_roe</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">dissipation_roe(u_ll, u_rr, orientation_or_normal_direction,
                                equations::ShallowWaterEquations2D)</code></pre><p>Roe-type dissipation term for the <a href="#TrixiShallowWater.ShallowWaterEquations2D"><code>ShallowWaterEquations2D</code></a>. To create the classical Roe solver, this dissipation term can be combined with <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.flux_central-Tuple%7BAny%2C%20Any%2C%20Any%2C%20Trixi.AbstractEquations%7D"><code>Trixi.flux_central</code></a> using <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.FluxPlusDissipation"><code>Trixi.FluxPlusDissipation</code></a>.</p><p>For details on the Roe linearization see Chapter 15.3.2 and Chapter 21.7 for the two-dimensional shallow water equations of the book:</p><ul><li>Randall J. LeVeque (2002) Finite Volume Methods for Hyperbolic Problems <a href="https://doi.org/10.1017/CBO9780511791253">DOI: 10.1017/CBO9780511791253</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L1166-L1177">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.dissipation_roe-Tuple{Any, Any, Any, ShallowWaterEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.dissipation_roe-Tuple{Any, Any, Any, ShallowWaterEquations1D}"><code>TrixiShallowWater.dissipation_roe</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">dissipation_roe(u_ll, u_rr, orientation_or_normal_direction,
                                equations::ShallowWaterEquations1D)</code></pre><p>Roe-type dissipation term for the <a href="#TrixiShallowWater.ShallowWaterEquations1D"><code>ShallowWaterEquations1D</code></a>. To create the classical Roe solver, this dissipation term can be combined with <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.flux_central-Tuple%7BAny%2C%20Any%2C%20Any%2C%20Trixi.AbstractEquations%7D"><code>Trixi.flux_central</code></a> using <a href="https://trixi-framework.github.io/TrixiDocumentation/stable/reference-trixi/#Trixi.FluxPlusDissipation"><code>Trixi.FluxPlusDissipation</code></a>.</p><p>For details on the Roe linearization see Chapter 15.3.2 and Chapter 15.3.3 for the one-dimensional shallow water equations of the book:</p><ul><li>Randall J. LeVeque (2002) Finite Volume Methods for Hyperbolic Problems <a href="https://doi.org/10.1017/CBO9780511791253">DOI: 10.1017/CBO9780511791253</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L798-L809">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.dissipation_roe-Tuple{Any, Any, Any, ShallowWaterExnerEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.dissipation_roe-Tuple{Any, Any, Any, ShallowWaterExnerEquations1D}"><code>TrixiShallowWater.dissipation_roe</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">dissipation_roe(u_ll, u_rr, orientation_or_normal_direction,
                                equations::ShallowWaterExnerEquations1D)</code></pre><p>Roe-type dissipation term for the <a href="#TrixiShallowWater.ShallowWaterExnerEquations1D"><code>ShallowWaterExnerEquations1D</code></a> with an approximate Roe average for the sediment discharge <code>q_s</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_exner_1d.jl#L422-L427">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.eachlayer-Tuple{TrixiShallowWater.AbstractShallowWaterMultiLayerEquations}"><a class="docstring-binding" href="#TrixiShallowWater.eachlayer-Tuple{TrixiShallowWater.AbstractShallowWaterMultiLayerEquations}"><code>TrixiShallowWater.eachlayer</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">eachlayer(equations::AbstractShallowWaterMultiLayerEquations)</code></pre><p>Return an iterator over the indices that specify the location in relevant data structures for the layers in <code>AbstractShallowWaterMultiLayerEquations</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/equations.jl#L36-L41">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterExnerEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterExnerEquations1D}"><code>TrixiShallowWater.flux_ersing_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_ersing_etal(u_ll, u_rr, orientation::Integer,
                                 equations::ShallowWaterMultiLayerEquations1D)</code></pre><p>Entropy conservative split form, without the hydrostatic pressure. This flux should be used together with the nonconservative <a href="#TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterExnerEquations1D}"><code>flux_nonconservative_ersing_etal</code></a> to create a scheme that is entropy conservative and well-balanced.</p><p>To obtain an entropy stable formulation the <code>surface_flux</code> can be set as <code>FluxPlusDissipation(flux_ersing_etal, DissipationLocalLaxFriedrichs()), flux_nonconservative_ersing_etal</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_exner_1d.jl#L390-L400">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterMultiLayerEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterMultiLayerEquations1D}"><code>TrixiShallowWater.flux_ersing_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_ersing_etal(u_ll, u_rr, orientation::Integer,
                                 equations::ShallowWaterMultiLayerEquations1D)</code></pre><p>Total energy conservative (mathematical entropy for MLSWE) split form, without the hydrostatic pressure. When the bottom topography is nonzero this scheme will be well-balanced when used with the  nonconservative <a href="#TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterExnerEquations1D}"><code>flux_nonconservative_ersing_etal</code></a>.</p><p>To obtain an entropy stable formulation the <code>surface_flux</code> can be set as <code>FluxPlusDissipation(flux_ersing_etal, DissipationLocalLaxFriedrichs()), flux_nonconservative_ersing_etal</code>.</p><p>In the two-layer setting this combination is equivalent to the fluxes in:</p><ul><li>Patrick Ersing, Andrew R. Winters (2023) An entropy stable discontinuous Galerkin method for the two-layer shallow water equations on  curvilinear meshes <a href="https://doi.org/10.1007/s10915-024-02451-2">DOI: 10.1007/s10915-024-02451-2</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_1d.jl#L359-L376">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterMultiLayerEquations2D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterMultiLayerEquations2D}"><code>TrixiShallowWater.flux_ersing_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_ersing_etal(u_ll, u_rr, orientation::Integer,
                                 equations::ShallowWaterMultiLayerEquations2D)
flux_ersing_etal(u_ll, u_rr, normal_direction::AbstractVector,
                                 equations::ShallowWaterMultiLayerEquations2D)</code></pre><p>Total energy conservative (mathematical entropy for MLSWE) split form, without the hydrostatic pressure. When the bottom topography is nonzero this scheme will be well-balanced when used with the nonconservative <a href="#TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterExnerEquations1D}"><code>flux_nonconservative_ersing_etal</code></a>.</p><p>To obtain an entropy stable formulation the <code>surface_flux</code> can be set as <code>FluxPlusDissipation(flux_ersing_etal, DissipationLocalLaxFriedrichs()), flux_nonconservative_ersing_etal</code>.</p><p>In the two-layer setting this combination is equivalent to the fluxes in:</p><ul><li>Patrick Ersing, Andrew R. Winters (2023) An entropy stable discontinuous Galerkin method for the two-layer shallow water equations on curvilinear meshes <a href="https://doi.org/10.1007/s10915-024-02451-2">DOI: 10.1007/s10915-024-02451-2</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_2d.jl#L822-L841">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_es_ersing_etal-Tuple{Any, Any, Any, ShallowWaterTwoLayerEquations2D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_es_ersing_etal-Tuple{Any, Any, Any, ShallowWaterTwoLayerEquations2D}"><code>TrixiShallowWater.flux_es_ersing_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_es_ersing_etal(u_ll, u_rr, orientation_or_normal_direction,
                    equations::ShallowWaterTwoLayerEquations2D)</code></pre><p>Entropy stable surface flux for the two-layer shallow water equations. Uses the entropy conservative  <a href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_wintermeyer_etal</code></a> and adds a Lax-Friedrichs type dissipation dependent on the jump of  entropy variables. </p><p>For further details see:</p><ul><li>Patrick Ersing, Andrew R. Winters (2023) An entropy stable discontinuous Galerkin method for the two-layer shallow water equations on  curvilinear meshes <a href="https://doi.org/10.1007/s10915-024-02451-2">DOI: 10.1007/s10915-024-02451-2</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_2d.jl#L506-L519">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_es_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterTwoLayerEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_es_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterTwoLayerEquations1D}"><code>TrixiShallowWater.flux_es_ersing_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_es_ersing_etal(u_ll, u_rr, orientation_or_normal_direction,
                    equations::ShallowWaterTwoLayerEquations1D)</code></pre><p>Entropy stable surface flux for the two-layer shallow water equations. Uses the entropy conservative  <a href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_wintermeyer_etal</code></a> and adds a Lax-Friedrichs type dissipation dependent on the jump of  entropy variables. </p><p>For further details see:</p><ul><li>Patrick Ersing, Andrew R. Winters (2023) An entropy stable discontinuous Galerkin method for the two-layer shallow water equations on  curvilinear meshes <a href="https://doi.org/10.1007/s10915-024-02451-2">DOI: 10.1007/s10915-024-02451-2</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_1d.jl#L310-L322">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_nonconservative_audusse_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_nonconservative_audusse_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>TrixiShallowWater.flux_nonconservative_audusse_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_audusse_etal(u_ll, u_rr, orientation::Integer,
                                  equations::ShallowWaterEquations1D)</code></pre><p>Non-symmetric two-point surface flux that discretizes the nonconservative (source) term. The discretization uses the <a href="#TrixiShallowWater.hydrostatic_reconstruction_audusse_etal-Tuple{Any, Any, ShallowWaterEquations1D}"><code>hydrostatic_reconstruction_audusse_etal</code></a> on the conservative variables.</p><p>This hydrostatic reconstruction ensures that the finite volume numerical fluxes remain well-balanced for discontinuous bottom topographies <a href="#TrixiShallowWater.ShallowWaterEquations1D"><code>ShallowWaterEquations1D</code></a>. Should be used together with <a href="#TrixiShallowWater.FluxHydrostaticReconstruction"><code>FluxHydrostaticReconstruction</code></a> and <a href="#TrixiShallowWater.hydrostatic_reconstruction_audusse_etal-Tuple{Any, Any, ShallowWaterEquations1D}"><code>hydrostatic_reconstruction_audusse_etal</code></a> in the surface flux to ensure consistency.</p><p>Further details on the hydrostatic reconstruction and its motivation can be found in</p><ul><li>Emmanuel Audusse, François Bouchut, Marie-Odile Bristeau, Rupert Klein, and Benoit Perthame (2004) A fast and stable well-balanced scheme with hydrostatic reconstruction for shallow water flows <a href="https://doi.org/10.1137/S1064827503431090">DOI: 10.1137/S1064827503431090</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L489-L506">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_nonconservative_audusse_etal-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_nonconservative_audusse_etal-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><code>TrixiShallowWater.flux_nonconservative_audusse_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_audusse_etal(u_ll, u_rr, orientation::Integer,
                                  equations::ShallowWaterEquations2D)
flux_nonconservative_audusse_etal(u_ll, u_rr,
                                  normal_direction::AbstractVector,
                                  equations::ShallowWaterEquations2D)</code></pre><p>Non-symmetric two-point surface flux that discretizes the nonconservative (source) term. The discretization uses the <a href="#TrixiShallowWater.hydrostatic_reconstruction_audusse_etal-Tuple{Any, Any, ShallowWaterEquations1D}"><code>hydrostatic_reconstruction_audusse_etal</code></a> on the conservative variables.</p><p>This hydrostatic reconstruction ensures that the finite volume numerical fluxes remain well-balanced for discontinuous bottom topographies <a href="#TrixiShallowWater.ShallowWaterEquations2D"><code>ShallowWaterEquations2D</code></a>. Should be used together with <a href="#TrixiShallowWater.FluxHydrostaticReconstruction"><code>FluxHydrostaticReconstruction</code></a> and <a href="#TrixiShallowWater.hydrostatic_reconstruction_audusse_etal-Tuple{Any, Any, ShallowWaterEquations1D}"><code>hydrostatic_reconstruction_audusse_etal</code></a> in the surface flux to ensure consistency.</p><p>Further details for the hydrostatic reconstruction and its motivation can be found in</p><ul><li>Emmanuel Audusse, François Bouchut, Marie-Odile Bristeau, Rupert Klein, and Benoit Perthame (2004) A fast and stable well-balanced scheme with hydrostatic reconstruction for shallow water flows <a href="https://doi.org/10.1137/S1064827503431090">DOI: 10.1137/S1064827503431090</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L846-L866">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_nonconservative_chen_noelle-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_nonconservative_chen_noelle-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>TrixiShallowWater.flux_nonconservative_chen_noelle</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_chen_noelle(u_ll, u_rr,
                                 orientation::Integer,
                                 equations::ShallowWaterEquations1D)</code></pre><p>Non-symmetric two-point surface flux that discretizes the nonconservative (source) term. The discretization uses the <a href="#TrixiShallowWater.hydrostatic_reconstruction_chen_noelle-Tuple{Any, Any, ShallowWaterEquations1D}"><code>hydrostatic_reconstruction_chen_noelle</code></a> on the conservative variables.</p><p>Should be used together with <a href="#TrixiShallowWater.FluxHydrostaticReconstruction"><code>FluxHydrostaticReconstruction</code></a> and <a href="#TrixiShallowWater.hydrostatic_reconstruction_chen_noelle-Tuple{Any, Any, ShallowWaterEquations1D}"><code>hydrostatic_reconstruction_chen_noelle</code></a> in the surface flux to ensure consistency.</p><p>Further details on the hydrostatic reconstruction and its motivation can be found in</p><ul><li>Guoxian Chen and Sebastian Noelle (2017) A new hydrostatic reconstruction scheme based on subcell reconstructions <a href="https://dx.doi.org/10.1137/15M1053074">DOI:10.1137/15M1053074</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L524-L540">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_nonconservative_chen_noelle-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_nonconservative_chen_noelle-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><code>TrixiShallowWater.flux_nonconservative_chen_noelle</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_chen_noelle(u_ll, u_rr,
                                 orientation::Integer,
                                 equations::ShallowWaterEquations2D)
flux_nonconservative_chen_noelle(u_ll, u_rr,
                                 normal_direction::AbstractVector,
                                 equations::ShallowWaterEquations2D)</code></pre><p>Non-symmetric two-point surface flux that discretizes the nonconservative (source) term. The discretization uses the <a href="#TrixiShallowWater.hydrostatic_reconstruction_chen_noelle-Tuple{Any, Any, ShallowWaterEquations1D}"><code>hydrostatic_reconstruction_chen_noelle</code></a> on the conservative variables.</p><p>Should be used together with <a href="#TrixiShallowWater.FluxHydrostaticReconstruction"><code>FluxHydrostaticReconstruction</code></a> and <a href="#TrixiShallowWater.hydrostatic_reconstruction_chen_noelle-Tuple{Any, Any, ShallowWaterEquations1D}"><code>hydrostatic_reconstruction_chen_noelle</code></a> in the surface flux to ensure consistency.</p><p>Further details on the hydrostatic reconstruction and its motivation can be found in</p><ul><li>Guoxian Chen and Sebastian Noelle (2017) A new hydrostatic reconstruction scheme based on subcell reconstructions <a href="https://dx.doi.org/10.1137/15M1053074">DOI:10.1137/15M1053074</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L913-L932">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterExnerEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterExnerEquations1D}"><code>TrixiShallowWater.flux_nonconservative_ersing_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_ersing_etal(u_ll, u_rr, orientation, equations::ShallowWaterExnerEquations1D)</code></pre><p>Non-symmetric path-conservative two-point flux discretizing the nonconservative terms of the <a href="#TrixiShallowWater.ShallowWaterExnerEquations1D"><code>ShallowWaterExnerEquations1D</code></a> which consists of the hydrostatic pressure of the fluid layer and an additional pressure contribution from the sediment layer to obtain an entropy inequality.</p><p>This non-conservative flux should be used together with <a href="#TrixiShallowWater.flux_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterExnerEquations1D}"><code>flux_ersing_etal</code></a> to create a scheme that is entropy conservative and well-balanced.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_exner_1d.jl#L351-L361">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterMultiLayerEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterMultiLayerEquations1D}"><code>TrixiShallowWater.flux_nonconservative_ersing_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_ersing_etal(u_ll, u_rr, orientation::Integer,
                                 equations::ShallowWaterTwoLayerEquations1D)</code></pre><p>Non-symmetric path-conservative two-point flux discretizing the nonconservative (source) term that contains the gradients of the bottom topography and waterheights from the coupling between layers and the nonconservative pressure formulation <a href="#TrixiShallowWater.ShallowWaterMultiLayerEquations1D"><code>ShallowWaterMultiLayerEquations1D</code></a>.</p><p>When the bottom topography is nonzero this scheme will be well-balanced when used with <a href="#TrixiShallowWater.flux_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterExnerEquations1D}"><code>flux_ersing_etal</code></a>.</p><p>In the two-layer setting this combination is equivalent to the fluxes in:</p><ul><li>Patrick Ersing, Andrew R. Winters (2023) An entropy stable discontinuous Galerkin method for the two-layer shallow water equations on  curvilinear meshes <a href="https://doi.org/10.1007/s10915-024-02451-2">DOI: 10.1007/s10915-024-02451-2</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_1d.jl#L307-L322">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterMultiLayerEquations2D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterMultiLayerEquations2D}"><code>TrixiShallowWater.flux_nonconservative_ersing_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_ersing_etal(u_ll, u_rr, orientation::Integer,
                                 equations::ShallowWaterMultiLayerEquations2D)
flux_nonconservative_ersing_etal(u_ll, u_rr,
                                 normal_direction::AbstractVector,
                                 equations::ShallowWaterMultiLayerEquations2D)</code></pre><p>Non-symmetric path-conservative two-point flux discretizing the nonconservative (source) term that contains the gradients of the bottom topography and waterheights from the coupling between layers and the nonconservative pressure formulation <a href="#TrixiShallowWater.ShallowWaterMultiLayerEquations2D"><code>ShallowWaterMultiLayerEquations2D</code></a>.</p><p>When the bottom topography is nonzero this scheme will be well-balanced when used with <a href="#TrixiShallowWater.flux_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterExnerEquations1D}"><code>flux_ersing_etal</code></a>.</p><p>In the two-layer setting this combination is equivalent to the fluxes in:</p><ul><li>Patrick Ersing, Andrew R. Winters (2023) An entropy stable discontinuous Galerkin method for the two-layer shallow water equations on curvilinear meshes <a href="https://doi.org/10.1007/s10915-024-02451-2">DOI: 10.1007/s10915-024-02451-2</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_2d.jl#L500-L518">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterTwoLayerEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterTwoLayerEquations1D}"><code>TrixiShallowWater.flux_nonconservative_ersing_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_ersing_etal(u_ll, u_rr, orientation::Integer,
                                 equations::ShallowWaterTwoLayerEquations1D)</code></pre><p>Non-symmetric path-conservative two-point volume flux discretizing the nonconservative (source) term that contains the gradient of the bottom topography <a href="#TrixiShallowWater.ShallowWaterTwoLayerEquations1D"><code>ShallowWaterTwoLayerEquations1D</code></a> and an additional term that couples the momentum of both layers. </p><p>This is a modified version of <a href="#Trixi.flux_nonconservative_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_nonconservative_wintermeyer_etal</code></a> that gives entropy  conservation and well-balancedness in both the volume and surface when combined with  <a href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_wintermeyer_etal</code></a>. </p><p>For further details see:</p><ul><li>Patrick Ersing, Andrew R. Winters (2023) An entropy stable discontinuous Galerkin method for the two-layer shallow water equations on  curvilinear meshes <a href="https://doi.org/10.1007/s10915-024-02451-2">DOI: 10.1007/s10915-024-02451-2</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_1d.jl#L224-L241">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterTwoLayerEquations2D}"><a class="docstring-binding" href="#TrixiShallowWater.flux_nonconservative_ersing_etal-Tuple{Any, Any, Integer, ShallowWaterTwoLayerEquations2D}"><code>TrixiShallowWater.flux_nonconservative_ersing_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">flux_nonconservative_ersing_etal(u_ll, u_rr, orientation::Integer,
                                 equations::ShallowWaterTwoLayerEquations2D)
flux_nonconservative_ersing_etal(u_ll, u_rr,
                                 normal_direction::AbstractVector,
                                 equations::ShallowWaterTwoLayerEquations2D)</code></pre><p>Non-symmetric path-conservative two-point volume flux discretizing the nonconservative (source) term that contains the gradient of the bottom topography <a href="#TrixiShallowWater.ShallowWaterTwoLayerEquations2D"><code>ShallowWaterTwoLayerEquations2D</code></a> and an additional term that couples the momentum of both layers. </p><p>This is a modified version of <a href="#Trixi.flux_nonconservative_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_nonconservative_wintermeyer_etal</code></a> that gives entropy  conservation and well-balancedness in both the volume and surface when combined with  <a href="#Trixi.flux_wintermeyer_etal-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>flux_wintermeyer_etal</code></a>.</p><p>For further details see:</p><ul><li>Patrick Ersing, Andrew R. Winters (2023) An entropy stable discontinuous Galerkin method for the two-layer shallow water equations on  curvilinear meshes <a href="https://doi.org/10.1007/s10915-024-02451-2">DOI: 10.1007/s10915-024-02451-2</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_two_layer_2d.jl#L326-L346">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.hydrostatic_reconstruction_audusse_etal-Tuple{Any, Any, ShallowWaterEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.hydrostatic_reconstruction_audusse_etal-Tuple{Any, Any, ShallowWaterEquations1D}"><code>TrixiShallowWater.hydrostatic_reconstruction_audusse_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">hydrostatic_reconstruction_audusse_etal(u_ll, u_rr, orientation::Integer,
                                        equations::ShallowWaterEquations1D)</code></pre><p>A particular type of hydrostatic reconstruction on the water height to guarantee well-balancedness for a general bottom topography <a href="#TrixiShallowWater.ShallowWaterEquations1D"><code>ShallowWaterEquations1D</code></a>. The reconstructed solution states <code>u_ll_star</code> and <code>u_rr_star</code> variables are then used to evaluate the surface numerical flux at the interface. Use in combination with the generic numerical flux routine <a href="#TrixiShallowWater.FluxHydrostaticReconstruction"><code>FluxHydrostaticReconstruction</code></a>.</p><p>Further details on this hydrostatic reconstruction and its motivation can be found in</p><ul><li>Emmanuel Audusse, François Bouchut, Marie-Odile Bristeau, Rupert Klein, and Benoit Perthame (2004) A fast and stable well-balanced scheme with hydrostatic reconstruction for shallow water flows <a href="https://doi.org/10.1137/S1064827503431090">DOI: 10.1137/S1064827503431090</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L636-L649">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.hydrostatic_reconstruction_audusse_etal-Tuple{Any, Any, ShallowWaterEquations2D}"><a class="docstring-binding" href="#TrixiShallowWater.hydrostatic_reconstruction_audusse_etal-Tuple{Any, Any, ShallowWaterEquations2D}"><code>TrixiShallowWater.hydrostatic_reconstruction_audusse_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">hydrostatic_reconstruction_audusse_etal(u_ll, u_rr, orientation_or_normal_direction,
                                        equations::ShallowWaterEquations2D)</code></pre><p>A particular type of hydrostatic reconstruction on the water height to guarantee well-balancedness for a general bottom topography <a href="#TrixiShallowWater.ShallowWaterEquations2D"><code>ShallowWaterEquations2D</code></a>. The reconstructed solution states <code>u_ll_star</code> and <code>u_rr_star</code> variables are used to evaluate the surface numerical flux at the interface. Use in combination with the generic numerical flux routine <a href="#TrixiShallowWater.FluxHydrostaticReconstruction"><code>FluxHydrostaticReconstruction</code></a>.</p><p>Further details for the hydrostatic reconstruction and its motivation can be found in</p><ul><li>Emmanuel Audusse, François Bouchut, Marie-Odile Bristeau, Rupert Klein, and Benoit Perthame (2004) A fast and stable well-balanced scheme with hydrostatic reconstruction for shallow water flows <a href="https://doi.org/10.1137/S1064827503431090">DOI: 10.1137/S1064827503431090</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L748-L761">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.hydrostatic_reconstruction_chen_noelle-Tuple{Any, Any, ShallowWaterEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.hydrostatic_reconstruction_chen_noelle-Tuple{Any, Any, ShallowWaterEquations1D}"><code>TrixiShallowWater.hydrostatic_reconstruction_chen_noelle</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">hydrostatic_reconstruction_chen_noelle(u_ll, u_rr, orientation::Integer,
                                       equations::ShallowWaterEquations1D)</code></pre><p>A particular type of hydrostatic reconstruction of the water height to guarantee well-balancedness for a general bottom topography of the <a href="#TrixiShallowWater.ShallowWaterEquations1D"><code>ShallowWaterEquations1D</code></a>. The reconstructed solution states <code>u_ll_star</code> and <code>u_rr_star</code> variables are used to evaluate the surface numerical flux at the interface. The key idea is a linear reconstruction of the bottom and water height at the interfaces using subcells. Use in combination with the generic numerical flux routine <a href="#TrixiShallowWater.FluxHydrostaticReconstruction"><code>FluxHydrostaticReconstruction</code></a>.</p><p>Further details on this hydrostatic reconstruction and its motivation can be found in</p><ul><li>Guoxian Chen and Sebastian Noelle (2017) A new hydrostatic reconstruction scheme based on subcell reconstructions <a href="https://dx.doi.org/10.1137/15M1053074">DOI:10.1137/15M1053074</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L672-L686">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.hydrostatic_reconstruction_chen_noelle-Tuple{Any, Any, ShallowWaterEquations2D}"><a class="docstring-binding" href="#TrixiShallowWater.hydrostatic_reconstruction_chen_noelle-Tuple{Any, Any, ShallowWaterEquations2D}"><code>TrixiShallowWater.hydrostatic_reconstruction_chen_noelle</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">hydrostatic_reconstruction_chen_noelle(u_ll, u_rr, orientation::Integer,
                                       equations::ShallowWaterEquations2D)</code></pre><p>A particular type of hydrostatic reconstruction of the water height to guarantee well-balancedness for a general bottom topography of the <a href="#TrixiShallowWater.ShallowWaterEquations2D"><code>ShallowWaterEquations2D</code></a>. The reconstructed solution states <code>u_ll_star</code> and <code>u_rr_star</code> variables are then used to evaluate the surface numerical flux at the interface. The key idea is a linear reconstruction of the bottom and water height at the interfaces using subcells. Use in combination with the generic numerical flux routine <a href="#TrixiShallowWater.FluxHydrostaticReconstruction"><code>FluxHydrostaticReconstruction</code></a>.</p><p>Further details on this hydrostatic reconstruction and its motivation can be found in</p><ul><li>Guoxian Chen and Sebastian Noelle (2017) A new hydrostatic reconstruction scheme based on subcell reconstructions <a href="https://dx.doi.org/10.1137/15M1053074">DOI:10.1137/15M1053074</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L784-L798">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.hydrostatic_reconstruction_ersing_etal-Tuple{Any, Any, ShallowWaterMultiLayerEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.hydrostatic_reconstruction_ersing_etal-Tuple{Any, Any, ShallowWaterMultiLayerEquations1D}"><code>TrixiShallowWater.hydrostatic_reconstruction_ersing_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">hydrostatic_reconstruction_ersing_etal(u_ll, u_rr, equations::ShallowWaterMultiLayerEquations1D)</code></pre><p>A particular hydrostatic reconstruction of the water height and bottom topography to  guarantee well-balancedness in the presence of wet/dry transitions and entropy stability for the  <a href="#TrixiShallowWater.ShallowWaterMultiLayerEquations1D"><code>ShallowWaterMultiLayerEquations1D</code></a>.  The reconstructed solution states <code>u_ll_star</code> and <code>u_rr_star</code> are used to evaluate the  surface numerical flux at the interface. The key idea is a piecewise linear reconstruction of the  bottom topography and water height interfaces using subcells, where the bottom topography is allowed  to be discontinuous.  Use in combination with the generic numerical flux routine <a href="#TrixiShallowWater.FluxHydrostaticReconstruction"><code>FluxHydrostaticReconstruction</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_1d.jl#L407-L418">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.hydrostatic_reconstruction_ersing_etal-Tuple{Any, Any, ShallowWaterMultiLayerEquations2D}"><a class="docstring-binding" href="#TrixiShallowWater.hydrostatic_reconstruction_ersing_etal-Tuple{Any, Any, ShallowWaterMultiLayerEquations2D}"><code>TrixiShallowWater.hydrostatic_reconstruction_ersing_etal</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">hydrostatic_reconstruction_ersing_etal(u_ll, u_rr, equations::ShallowWaterMultiLayerEquations2D)</code></pre><p>A particular type of hydrostatic reconstruction of the water height and bottom topography to guarantee well-balancedness in the presence of wet/dry transitions and entropy stability for the <a href="#TrixiShallowWater.ShallowWaterMultiLayerEquations2D"><code>ShallowWaterMultiLayerEquations2D</code></a>. The reconstructed solution states <code>u_ll_star</code> and <code>u_rr_star</code> variables are used to evaluate the surface numerical flux at the interface. The key idea is a piecewise linear reconstruction of the bottom topography and water height interfaces using subcells, where the bottom topography is allowed to be discontinuous. Use in combination with the generic numerical flux routine <a href="#TrixiShallowWater.FluxHydrostaticReconstruction"><code>FluxHydrostaticReconstruction</code></a>.</p><ul><li>Patrick Ersing, Sven Goldberg, and Andrew R. Winters (2025) Entropy stable hydrostatic reconstruction schemes for shallow water systems <a href="https://doi.org/10.1016/j.jcp.2025.113802">DOI: 10.1016/j.jcp.2025.113802</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_multilayer_2d.jl#L915-L930">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.min_max_speed_chen_noelle-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.min_max_speed_chen_noelle-Tuple{Any, Any, Integer, ShallowWaterEquations1D}"><code>TrixiShallowWater.min_max_speed_chen_noelle</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">min_max_speed_chen_noelle(u_ll, u_rr, orientation::Integer,
                          equations::ShallowWaterEquations1D)</code></pre><p>The approximated speeds for the HLL type numerical flux used by Chen and Noelle for their hydrostatic reconstruction. As they state in the paper, these speeds are chosen for the numerical flux to ensure positivity and to satisfy an entropy inequality.</p><p>Further details on this hydrostatic reconstruction and its motivation can be found in</p><ul><li>Guoxian Chen and Sebastian Noelle (2017) A new hydrostatic reconstruction scheme based on subcell reconstructions <a href="https://dx.doi.org/10.1137/15M1053074">DOI:10.1137/15M1053074</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_1d.jl#L848-L860">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.min_max_speed_chen_noelle-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><a class="docstring-binding" href="#TrixiShallowWater.min_max_speed_chen_noelle-Tuple{Any, Any, Integer, ShallowWaterEquations2D}"><code>TrixiShallowWater.min_max_speed_chen_noelle</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">min_max_speed_chen_noelle(u_ll, u_rr, orientation::Integer,
                          equations::ShallowWaterEquations2D)
min_max_speed_chen_noelle(u_ll, u_rr, normal_direction::AbstractVector,
                          equations::ShallowWaterEquations2D)</code></pre><p>Special estimate of the minimal and maximal wave speed of the shallow water equations for the left and right states <code>u_ll, u_rr</code>. These approximate speeds are used for the HLL-type numerical flux <a href="#TrixiShallowWater.flux_hll_chen_noelle"><code>flux_hll_chen_noelle</code></a>. These wave speed estimates together with a particular hydrostatic reconstruction technique guarantee that the numerical flux is positive and satisfies an entropy inequality.</p><p>Further details on this hydrostatic reconstruction and its motivation can be found in the reference below. The definition of the wave speeds are given in Equation (2.20).</p><ul><li>Guoxian Chen and Sebastian Noelle (2017) A new hydrostatic reconstruction scheme based on subcell reconstructions <a href="https://dx.doi.org/10.1137/15M1053074">DOI:10.1137/15M1053074</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_2d.jl#L1261-L1278">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.nlayers-Union{Tuple{TrixiShallowWater.AbstractShallowWaterMultiLayerEquations{NDIMS, NVARS, NLAYERS}}, Tuple{NLAYERS}, Tuple{NVARS}, Tuple{NDIMS}} where {NDIMS, NVARS, NLAYERS}"><a class="docstring-binding" href="#TrixiShallowWater.nlayers-Union{Tuple{TrixiShallowWater.AbstractShallowWaterMultiLayerEquations{NDIMS, NVARS, NLAYERS}}, Tuple{NLAYERS}, Tuple{NVARS}, Tuple{NDIMS}} where {NDIMS, NVARS, NLAYERS}"><code>TrixiShallowWater.nlayers</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">nlayers(equations::AbstractShallowWaterMultiLayerEquations)</code></pre><p>Retrieve the number of layers from an equation instance of the <code>AbstractShallowWaterMultiLayerEquations</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/equations.jl#L46-L50">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TrixiShallowWater.source_term_bottom_friction-Tuple{Any, Any, Any, ShallowWaterExnerEquations1D}"><a class="docstring-binding" href="#TrixiShallowWater.source_term_bottom_friction-Tuple{Any, Any, Any, ShallowWaterExnerEquations1D}"><code>TrixiShallowWater.source_term_bottom_friction</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">source_term_bottom_friction(u, x, t, equations::ShallowWaterExnerEquations1D)</code></pre><p>Source term that accounts for the bottom friction in the <a href="#TrixiShallowWater.ShallowWaterExnerEquations1D">ShallowWaterExnerEquations1D</a>. The actual friction law is determined through the friction model in <code>equations.friction</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/trixi-framework/TrixiShallowWater.jl/blob/3ec9f166e94356a07e85502520c86c84fa45dbf4/src/equations/shallow_water_exner_1d.jl#L324-L329">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../license/">« License</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 7 February 2026 18:26">Saturday 7 February 2026</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
